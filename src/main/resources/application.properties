spring.application.name=PizzaNat

# PostgreSQL
spring.datasource.url=jdbc:postgresql://postgres:5432/pizzanat_db
#spring.datasource.url=jdbc:postgresql://pizzanat-postgres:5432/pizzanat_db
spring.datasource.username=pizzanat_user
spring.datasource.password=strong_password_change_me
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.show-sql=false
spring.jpa.open-in-view=false

# Flyway
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration

# Расширенные настройки Flyway
spring.flyway.out-of-order=true
spring.flyway.ignore-missing-migrations=true
spring.flyway.ignore-future-migrations=true
spring.flyway.repair-on-migrate=true

# JWT Configuration
jwt.secret=YTg1MmViNjM0MWY5MTk4NTk1OWM4YzhjZTRlMjIzMTZmNWI1ODk3YmY3YmI3NjhjNWFmYTU1NDYzY2E3OGVmMg==
jwt.expiration=86400000
jwt.issuer=PizzaNat

# Redis
spring.data.redis.host=redis
spring.data.redis.port=6379
spring.data.redis.timeout=2000
spring.data.redis.password=strong_redis_password_change_me

# S3 (настройки для контейнера MinIO из docker-compose)
s3.access-key=accesskey
s3.secret-key=secretkey
s3.endpoint=http://minio:9000
s3.public-url=http://localhost/
s3.bucket=pizzanat

# Таймауты для HTTP-клиентов (для MinIO)
spring.codec.max-in-memory-size=20MB
spring.servlet.multipart.max-file-size=20MB
spring.servlet.multipart.max-request-size=20MB

# Настройки для уведомлений
app.notification.email.from=no-reply@pizzanat.com
app.notification.email.enabled=false

# Настройки почтового сервера (для тестового окружения - отключено)
spring.mail.host=smtp.example.com
spring.mail.port=587
spring.mail.username=mail@example.com
spring.mail.password=mail_password
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

# Включение детальных сообщений об ошибках
server.error.include-message=always
server.error.include-binding-errors=always

# Отключение JWT проверки (для разработки)
app.security.jwt.skip-auth-urls=/api/v1/auth/**,/swagger-ui/**,/v3/api-docs/**

# Dev-specific settings
logging.level.com.baganov.pizzanat=INFO
logging.level.org.hibernate.SQL=INFO

# Параметр для разрешения циклических зависимостей
spring.main.allow-circular-references=true

# Настройка отказоустойчивости для S3/MinIO
spring.cloud.aws.client.connection-timeout=5000
spring.cloud.aws.client.socket-timeout=5000

# Настройки сервера для доступа извне
server.address=0.0.0.0
server.port=8080

# Расширенные настройки логирования
logging.level.org.springframework.security=INFO
logging.level.org.springframework.web=INFO

# Настройки платежной системы Robokassa
payment.robokassa.merchant-login=your_merchant_login
payment.robokassa.password1=your_password1
payment.robokassa.password2=your_password2
payment.robokassa.test-mode=true
payment.robokassa.base-url=https://auth.robokassa.ru/Merchant/Index.aspx

# Настройки Resilience4j для Circuit Breaker
resilience4j.circuitbreaker.instances.robokassa.failure-rate-threshold=50
resilience4j.circuitbreaker.instances.robokassa.minimum-number-of-calls=5
resilience4j.circuitbreaker.instances.robokassa.automatic-transition-from-open-to-half-open-enabled=true
resilience4j.circuitbreaker.instances.robokassa.wait-duration-in-open-state=10s
resilience4j.circuitbreaker.instances.robokassa.permitted-number-of-calls-in-half-open-state=3
resilience4j.circuitbreaker.instances.robokassa.sliding-window-size=10
resilience4j.circuitbreaker.instances.robokassa.sliding-window-type=COUNT_BASED

# Настройки Resilience4j для Retry
resilience4j.retry.instances.robokassa.max-attempts=3
resilience4j.retry.instances.robokassa.wait-duration=500ms
resilience4j.retry.instances.robokassa.retry-exceptions=java.io.IOException,java.net.SocketTimeoutException

# Настройки SpringDoc и Swagger UI
springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui/index.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.tagsSorter=alpha
springdoc.swagger-ui.tryItOutEnabled=true
springdoc.swagger-ui.filter=true
springdoc.swagger-ui.syntaxHighlight.activated=true
springdoc.packages-to-scan=com.baganov.pizzanat.controller
springdoc.paths-to-match=/api/v1/**

# Отключение вывода % в конце JSON-ответов
spring.http.encoding.force=true
spring.mvc.contentnegotiation.media-types.json=application/json
spring.jackson.serialization.indent-output=true