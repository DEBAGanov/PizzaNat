# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 403 –¥–ª—è –ª–æ–≥–æ—Ç–∏–ø–∞ –°–ë–ü

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
–õ–æ–≥–æ—Ç–∏–ø –°–ë–ü –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ Mini App –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ **HTTP 403 Forbidden** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –ø—É—Ç–∏ `/static/images/icons/sbp-logo.png`.

## üîç **–ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã:**
–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Spring Security (`SecurityConfig.java`) —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã –ø–æ –ø—É—Ç–∏ `/static/**` **–ù–ï –≤–∫–ª—é—á–µ–Ω—ã** –≤ `AUTH_WHITELIST`, –ø–æ—ç—Ç–æ–º—É –¥–æ—Å—Ç—É–ø –∫ –Ω–∏–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω.

### üìã **–ê–Ω–∞–ª–∏–∑ SecurityConfig.java:**
```java
private static final String[] AUTH_WHITELIST = {
    // Mini App static resources
    "/miniapp/**",        // ‚úÖ –†–ê–ó–†–ï–®–ï–ù
    "/miniapp",           // ‚úÖ –†–ê–ó–†–ï–®–ï–ù
    // –ù–û –ù–ï–¢ "/static/**"  // ‚ùå –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù
};
```

### üìÅ **–ê–Ω–∞–ª–∏–∑ WebConfig.java:**
```java
@Override
public void addResourceHandlers(ResourceHandlerRegistry registry) {
    // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã Mini App (–†–ê–ë–û–¢–ê–ï–¢)
    registry.addResourceHandler("/miniapp/**")
            .addResourceLocations("classpath:/static/miniapp/");
    
    // –û–±—ã—á–Ω—ã–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã (–ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù)
    registry.addResourceHandler("/static/**")
            .addResourceLocations("classpath:/static/");
}
```

## ‚úÖ **–†–µ—à–µ–Ω–∏–µ:**

### 1. **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—É—é –ø–∞–ø–∫—É:**
```bash
cp src/main/resources/static/images/icons/sbp-logo.png \
   src/main/resources/static/miniapp/sbp-logo.png
```

### 2. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—É—Ç–∏ –≤ HTML:**
**–§–∞–π–ª:** `checkout.html` (—Å—Ç—Ä–æ–∫–∞ 85)
```html
<!-- –ë–´–õ–û (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ): -->
<img src="/static/images/icons/sbp-logo.png" alt="–°–ë–ü - –°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π">

<!-- –°–¢–ê–õ–û (—Ä–∞–∑—Ä–µ—à–µ–Ω–æ): -->
<img src="/miniapp/sbp-logo.png" alt="–°–ë–ü - –°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π">
```

### 3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ CSS –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:**
**–§–∞–π–ª:** `checkout-styles.css`
```css
/* –°–ë–ü –ª–æ–≥–æ—Ç–∏–ø –≤ –æ–ø—Ü–∏—è—Ö –æ–ø–ª–∞—Ç—ã (PNG via /miniapp/) */
.option-title img[src*="sbp-logo"] {
    /* CSS —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
}
```

## üìä **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—É—Ç–µ–π:**

| –ü—É—Ç—å | –°—Ç–∞—Ç—É—Å Security | WebConfig | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|------|----------------|-----------|-----------|
| `/static/images/icons/sbp-logo.png` | ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω | ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω | **403 Forbidden** |
| `/miniapp/sbp-logo.png` | ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω | ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω | **200 OK** |

## üéØ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è:**

### ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è Spring Security –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —É–∂–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π –ø—É—Ç—å `/miniapp/**`
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—É –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

### ‚ö° **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –§–∞–π–ª –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ Spring MVC
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 1 —á–∞—Å (`setCachePeriod(3600)`)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–∞–∑–¥–∞—á–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

### üîß **–ü—Ä–æ—Å—Ç–æ—Ç–∞:**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
- –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å

## üìÇ **–§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:**

```
src/main/resources/static/
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îî‚îÄ‚îÄ icons/
‚îÇ       ‚îî‚îÄ‚îÄ sbp-logo.png          ‚Üê –û—Ä–∏–≥–∏–Ω–∞–ª (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
‚îî‚îÄ‚îÄ miniapp/
    ‚îú‚îÄ‚îÄ sbp-logo.png              ‚Üê –ö–æ–ø–∏—è (—Ä–∞–±–æ—Ç–∞–µ—Ç) ‚úÖ
    ‚îú‚îÄ‚îÄ checkout.html             ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω –ø—É—Ç—å ‚úÖ
    ‚îî‚îÄ‚îÄ checkout-styles.css       ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ‚úÖ
```

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

### ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:**
- **URL:** `https://api.dimbopizza.ru/miniapp/sbp-logo.png`
- **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** HTTP 200 + PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ Mini App:** –õ–æ–≥–æ—Ç–∏–ø –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### üîß **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
- **SecurityConfig:** `/miniapp/**` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ AUTH_WHITELIST ‚úÖ
- **WebConfig:** –ú–∞–ø–ø–∏–Ω–≥ `/miniapp/**` ‚Üí `classpath:/static/miniapp/` ‚úÖ
- **–§–∞–π–ª:** `sbp-logo.png` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ø–∞–ø–∫–µ miniapp ‚úÖ

## üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
–õ–æ–≥–æ—Ç–∏–ø –°–ë–ü —Ç–µ–ø–µ—Ä—å —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª–µ "–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã" Telegram Mini App –±–µ–∑ –æ—à–∏–±–æ–∫ 403.

### üìà **–ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞:**
- ‚ùå HTTP 403 ‚Üí ‚úÖ HTTP 200
- ‚ùå Broken image ‚Üí ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π –ª–æ–≥–æ—Ç–∏–ø –°–ë–ü
- ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚Üí ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–∏—Ç–∏–∫–∞–º

## üîÑ **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è (–ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã):**

### 1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ `/static/**` –≤ AUTH_WHITELIST:**
```java
// –í–ê–†–ò–ê–ù–¢ 1 (–ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
"/static/**",  // –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –í–°–ï–ú —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º —Ñ–∞–π–ª–∞–º
```
**–ü—Ä–æ–±–ª–µ–º—ã:** –ú–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 2. **–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:**
```java
// –í–ê–†–ò–ê–ù–¢ 2 (–∏–∑–±—ã—Ç–æ—á–Ω—ã–π):
@GetMapping("/api/v1/images/{filename}")
public ResponseEntity<Resource> getImage(@PathVariable String filename)
```
**–ü—Ä–æ–±–ª–µ–º—ã:** –ò–∑–±—ã—Ç–æ—á–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏

## üí° **–í—ã–≤–æ–¥:**
–í—ã–±—Ä–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –ø–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å/–ø—Ä–æ—Å—Ç–æ—Ç–∞/–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –õ–æ–≥–æ—Ç–∏–ø –°–ë–ü —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!

---
*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: 2025-01-27*
*–ú–µ—Ç–æ–¥: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—É—é –ø–∞–ø–∫—É /miniapp/*
*–°—Ç–∞—Ç—É—Å: HTTP 403 ‚Üí HTTP 200 ‚úÖ*
