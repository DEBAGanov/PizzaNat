# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∞–¥–º–∏–Ω—Å–∫–æ–≥–æ –±–æ—Ç–∞ –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–ª–∞—Ç –Æ–ö–∞—Å—Å–∞

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π (2025-01-28)

–í —Ä–∞–º–∫–∞—Ö —É–ª—É—á—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –±—ã–ª–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∞–¥–º–∏–Ω—Å–∫–∏–π Telegram –±–æ—Ç –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏ —á–µ—Ä–µ–∑ –Æ–ö–∞—Å—Å–∞.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –£–±—Ä–∞–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ —Å –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã–º–∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏

**–î–æ**: –ó–∞–∫–∞–∑—ã —Å –æ–ø–ª–∞—Ç–æ–π —á–µ—Ä–µ–∑ –°–ë–ü –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –≤ –∞–¥–º–∏–Ω—Å–∫–∏–π –±–æ—Ç –¥–æ –º–æ–º–µ–Ω—Ç–∞ –æ–ø–ª–∞—Ç—ã  
**–ü–æ—Å–ª–µ**: –í—Å–µ –∑–∞–∫–∞–∑—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –∞–¥–º–∏–Ω—Å–∫–∏–π –±–æ—Ç —Å—Ä–∞–∑—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

### 2. –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ

**–ù–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**: –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ —á–µ—Ä–µ–∑ –Æ–ö–∞—Å—Å–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤—Ç–æ—Ä–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø–æ–º–µ—Ç–∫–æ–π "‚úÖ –ó–ê–ö–ê–ó –û–ü–õ–ê–ß–ï–ù"

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ü–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ —Å –Ω–∞–ª–∏—á–Ω–æ–π –æ–ø–ª–∞—Ç–æ–π:
```
–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ‚Üí NewOrderEvent ‚Üí AdminBotService ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ –±–æ—Ç
```

### –ü–æ—Ç–æ–∫ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ —Å –æ–ø–ª–∞—Ç–æ–π —á–µ—Ä–µ–∑ –°–ë–ü:
```
1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ ‚Üí NewOrderEvent ‚Üí AdminBotService ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –∑–∞–∫–∞–∑–µ
2. Webhook –Æ–ö–∞—Å—Å–∞ ‚Üí YooKassaPaymentService ‚Üí NewOrderEvent ‚Üí AdminBotService ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–ø–ª–∞—Ç–µ
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

#### AdminBotService.java
- **–ú–µ—Ç–æ–¥**: `handleNewOrderEvent()`
- **–ò–∑–º–µ–Ω–µ–Ω–∏—è**: 
  - –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `hasActivePendingPayments()`
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–Ω–æ–≤—ã–π –∑–∞–∫–∞–∑ vs —É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞)
  - –í—Å–µ –∑–∞–∫–∞–∑—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

#### YooKassaPaymentService.java
- **–ú–µ—Ç–æ–¥**: `updateOrderStatusAfterPayment()`
- **–ò–∑–º–µ–Ω–µ–Ω–∏—è**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—è `NewOrderEvent` –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–ø–ª–∞—Ç–µ

### Webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**Endpoint**: `/api/v1/payments/yookassa/webhook`  
**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è**: `payment.succeeded`, `payment.canceled`  
**–û–±—Ä–∞–±–æ—Ç–∫–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 1. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –∑–∞–∫–∞–∑–µ
```
üÜï –ù–û–í–´–ô –ó–ê–ö–ê–ó #123

üë§ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –°–ò–°–¢–ï–ú–´
–ò–º—è: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
–¢–µ–ª–µ—Ñ–æ–Ω: +79991234567

üìû –ö–û–ù–¢–ê–ö–¢–ù–´–ï –î–ê–ù–ù–´–ï –ó–ê–ö–ê–ó–ê
–ò–º—è: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
–¢–µ–ª–µ—Ñ–æ–Ω: +79991234567

üìç –î–û–°–¢–ê–í–ö–ê
–ê–¥—Ä–µ—Å: —É–ª. –ü—É—à–∫–∏–Ω–∞, –¥. 1

üí≥ –°–ü–û–°–û–ë –û–ü–õ–ê–¢–´: –°–ë–ü
```

### 2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ
```
üÜï –ù–û–í–´–ô –ó–ê–ö–ê–ó #123 ‚úÖ –ó–ê–ö–ê–ó –û–ü–õ–ê–ß–ï–ù —á–µ—Ä–µ–∑ –°–ë–ü

[—Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞]

üí≥ –°–¢–ê–¢–£–° –û–ü–õ–ê–¢–´: ‚úÖ –ó–ê–ö–ê–ó –û–ü–õ–ê–ß–ï–ù —á–µ—Ä–µ–∑ –°–ë–ü
üí≥ –°–ü–û–°–û–ë –û–ü–õ–ê–¢–´: –°–ë–ü
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

1. **scripts/test_yookassa_webhook_integration.sh**
   - –ü–æ–ª–Ω—ã–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç
   - –°–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑, –ø–ª–∞—Ç–µ–∂, –∏–º–∏—Ç–∏—Ä—É–µ—Ç webhook
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å—é —Ü–µ–ø–æ—á–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏

2. **scripts/test_yookassa_webhook_simple.sh**
   - –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç webhook endpoint
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ successful payment

### –°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- ‚úÖ Health check –Æ–ö–∞—Å—Å–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Webhook endpoint –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –õ–æ–≥–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚ö†Ô∏è –ü–æ–ª–Ω–æ–µ end-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏

## –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã:

1. **–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –í—Å–µ –∑–∞–∫–∞–∑—ã –ø—Ä–∏—Ö–æ–¥—è—Ç —Å—Ä–∞–∑—É, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –Ω–∞—á–∞—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –¥–æ –æ–ø–ª–∞—Ç—ã
2. **–ß–µ—Ç–∫–∏–π —Å—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —è–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–≥–¥–∞ –∑–∞–∫–∞–∑ –æ–ø–ª–∞—á–µ–Ω
3. **–ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –í–∏–¥–Ω—ã –≤—Å–µ –∑–∞–∫–∞–∑—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã
4. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: Webhook –æ—Ç –Æ–ö–∞—Å—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

**–ó–∞–∫–∞–∑ —Å –æ–ø–ª–∞—Ç–æ–π –Ω–∞–ª–∏—á–Ω—ã–º–∏**:
- –ü—Ä–∏—Ö–æ–¥–∏—Ç –æ–¥–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç "–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: –ù–∞–ª–∏—á–Ω—ã–µ"

**–ó–∞–∫–∞–∑ —Å –æ–ø–ª–∞—Ç–æ–π —á–µ—Ä–µ–∑ –°–ë–ü**:
- –ü—Ä–∏—Ö–æ–¥–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ (–º–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –≥–æ—Ç–æ–≤–∏—Ç—å)
- –ü—Ä–∏—Ö–æ–¥–∏—Ç –≤—Ç–æ—Ä–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ (–º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å)

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–ª—é—á–µ–≤—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:

```java
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
log.info("‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –∑–∞–∫–∞–∑–µ #{} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∞–¥–º–∏–Ω—Å–∫–∏–π –±–æ—Ç", orderId);

// –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ
log.info("üí∞ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ –∑–∞–∫–∞–∑–∞ #{}", orderId);

// –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook
log.info("üîî –ü–æ–ª—É—á–µ–Ω webhook –æ—Ç –ÆKassa: —Ç–∏–ø={}", eventType);
log.info("‚úÖ Webhook –ÆKassa –æ–±—Ä–∞–±–æ—Ç–∞–Ω —É—Å–ø–µ—à–Ω–æ");
```

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç –Æ–ö–∞—Å—Å–∞
- –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ webhook
- –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞–ª–∏—á–Ω—ã–µ/–æ–Ω–ª–∞–π–Ω

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```
YOOKASSA_ENABLED=true
TELEGRAM_ADMIN_BOT_ENABLED=true
TELEGRAM_ADMIN_NOTIFICATIONS_ENABLED=true
```

### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- Webhook URL –≤ –Æ–ö–∞—Å—Å–∞: `https://api.dimbopizza.ru/api/v1/payments/yookassa/webhook`
- Telegram –±–æ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–æ–≥–æ –±–æ—Ç–∞
- –°–ø–∏—Å–æ–∫ chat ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º (2025-01-28)

### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –°–ë–ü –∑–∞–∫–∞–∑–æ–≤ –∫–∞–∫ "–ù–ê–õ–ò–ß–ù–´–ú–ò"

**–ü—Ä–æ–±–ª–µ–º–∞**: –ó–∞–∫–∞–∑—ã #25, #26 –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –≤ –∞–¥–º–∏–Ω—Å–∫–æ–º –±–æ—Ç–µ –∫–∞–∫ "üü¢ –ù–ê–õ–ò–ß–ù–´–ú–ò", —Ö–æ—Ç—è –±—ã–ª–∏ –æ–ø–ª–∞—á–µ–Ω—ã —á–µ—Ä–µ–∑ –°–ë–ü.

**–ü—Ä–∏—á–∏–Ω–∞**: 
- –í –ë–î –∑–∞–∫–∞–∑—ã –∏–º–µ–ª–∏ `payment_method = SBP`, `payment_status = PAID`
- –ù–æ –≤ Java –æ–±—ä–µ–∫—Ç–∞—Ö `Order.paymentMethod = null`, `Order.paymentStatus = null` 
- –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ `payments` (–ø–ª–∞—Ç–µ–∂–∏ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å —á–µ—Ä–µ–∑ API)
- `OrderDisplayStatus.determineStatus()` –≤–∏–¥–µ–ª `null` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–ª `CASH_NEW`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: 
- –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `determineOrderDisplayStatusFixed()` –≤ `AdminBotService`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —É—Å–ø–µ—à–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ `payments`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `paymentStatus` –∑–∞–∫–∞–∑–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç `paymentMethod`
- –õ–æ–≥–∏–∫–∞: –µ—Å–ª–∏ –µ—Å—Ç—å `SUCCEEDED` –ø–ª–∞—Ç–µ–∂ –ò–õ–ò `paymentStatus=PAID` ‚Üí `PAYMENT_SUCCESS`

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã**:
- `AdminBotService.java`: –¥–æ–±–∞–≤–ª–µ–Ω `determineOrderDisplayStatusFixed()`
- `formatNewOrderMessage()` –∏ `sendActiveOrdersWithButtons()` –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –ó–∞–∫–∞–∑—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –°–ë–ü –ø–ª–∞—Ç–µ–∂–∞–º–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–∞–∫ "üü¢ –û–ü–õ–ê–ß–ï–ù"
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –ë–î –∏ Java –æ–±—ä–µ–∫—Ç–∞–º–∏
- –°–æ–∑–¥–∞–Ω—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–¥–æ–±–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

### üìã –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã

- `scripts/diagnose_order_25.sh` - –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–∫–∞–∑–æ–º #25
- `scripts/diagnose_order_26.sh` - –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–∫–∞–∑–æ–º #26  
- `scripts/test_fixed_admin_bot.sh` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- Webhook endpoint –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –Æ–ö–∞—Å—Å–∞)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç –Æ–ö–∞—Å—Å–∞
- Graceful handling –æ—à–∏–±–æ–∫ - –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –ø–ª–∞—Ç–µ–∂–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –¥–ª—è –∞—É–¥–∏—Ç–∞ 