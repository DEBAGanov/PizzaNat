# üìã –¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–î–ê–ù–ò–ï 1: API —ç–Ω–¥–ø–æ–∏–Ω—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏

## üéØ –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **–≠–Ω–¥–ø–æ–∏–Ω—Ç**: `GET /api/v1/admin/stats`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è PizzaNat
- **–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å**: ‚ùå –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTTP 500 "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞"
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô - –∞–¥–º–∏–Ω–∫–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —ç—Ç–æ–≥–æ API
- **Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: [PizzaNatApp](https://github.com/DEBAGanov/PizzaNatApp)

## üîê –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

- **–ó–∞–≥–æ–ª–æ–≤–æ–∫**: `Authorization: Bearer <admin_jwt_token>`
- **–†–æ–ª–∏ –¥–æ—Å—Ç—É–ø–∞**: `SUPER_ADMIN`, `MANAGER`
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Ç–æ–∫–µ–Ω –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å –∞–¥–º–∏–Ω—Å–∫–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏
- **–ü—Ä–∏ –æ—à–∏–±–∫–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**: HTTP 401 —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞

### ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π JSON –æ—Ç–≤–µ—Ç (HTTP 200):

```json
{
  "totalOrders": 6,
  "totalRevenue": 3135.15,
  "totalProducts": 25,
  "totalCategories": 5,
  "ordersToday": 6,
  "revenueToday": 3135.15,
  "popularProducts": [
    {
      "productId": 1,
      "productName": "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
      "ordersCount": 3,
      "revenue": 1497.0
    },
    {
      "productId": 8,
      "productName": "–ü–∏—Ü—Ü–∞ –ö–∞—Ä–±–æ–Ω–∞—Ä–∞", 
      "ordersCount": 1,
      "revenue": 629.0
    },
    {
      "productId": 12,
      "productName": "–ë—É—Ä–≥–µ—Ä \"–ß–∏–∑–±—É—Ä–≥–µ—Ä\"",
      "ordersCount": 1,
      "revenue": 509.15
    }
  ],
  "orderStatusStats": {
    "CREATED": 6,
    "PENDING": 0,
    "CONFIRMED": 0,
    "PREPARING": 0,
    "READY": 0,
    "DELIVERING": 0,
    "DELIVERED": 0,
    "CANCELLED": 0
  }
}
```

## üóÇÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–ª–µ–π

### üìà –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
|------|-----|----------|----------------|
| totalOrders | int | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
| totalRevenue | double | –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ –∑–∞ –≤—Å–µ –≤—Ä–µ–º—è (‚ÇΩ) | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
| totalProducts | int | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
| totalCategories | int | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤ | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
| ordersToday | int | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∑–∞ —Å–µ–≥–æ–¥–Ω—è | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
| revenueToday | double | –í—ã—Ä—É—á–∫–∞ –∑–∞ —Å–µ–≥–æ–¥–Ω—è (‚ÇΩ) | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |

### üèÜ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã

–ú–∞—Å—Å–∏–≤ `popularProducts` (–¢–û–ü-5 –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤):

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| productId | long | ID –ø—Ä–æ–¥—É–∫—Ç–∞ |
| productName | string | –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ |
| ordersCount | int | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ —Å —ç—Ç–∏–º –ø—Ä–æ–¥—É–∫—Ç–æ–º |
| revenue | double | –í—ã—Ä—É—á–∫–∞ –æ—Ç –ø—Ä–æ–¥—É–∫—Ç–∞ (‚ÇΩ) |

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –∑–∞–∫–∞–∑–æ–≤

–û–±—ä–µ–∫—Ç `orderStatusStats` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É —Å—Ç–∞—Ç—É—Å—É:
- **CREATED** - —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
- **PENDING** - –æ–∂–∏–¥–∞—é—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- **CONFIRMED** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ
- **PREPARING** - –≥–æ—Ç–æ–≤—è—Ç—Å—è
- **READY** - –≥–æ—Ç–æ–≤—ã –∫ –≤—ã–¥–∞—á–µ
- **DELIVERING** - –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è
- **DELIVERED** - –¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã
- **CANCELLED** - –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ

## üíæ SQL –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞

### üîç –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

```sql
-- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤
SELECT COUNT(*) as totalOrders FROM orders;

-- –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞  
SELECT COALESCE(SUM(total_amount), 0) as totalRevenue FROM orders 
WHERE status != 'CANCELLED';

-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
SELECT COUNT(*) as totalProducts FROM products WHERE available = true;
SELECT COUNT(*) as totalCategories FROM categories;

-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
SELECT 
    COUNT(*) as ordersToday,
    COALESCE(SUM(total_amount), 0) as revenueToday 
FROM orders 
WHERE DATE(created_at) = CURRENT_DATE AND status != 'CANCELLED';
```

### üèÜ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã:

```sql
SELECT 
    p.id as productId,
    p.name as productName,
    COUNT(oi.id) as ordersCount,
    COALESCE(SUM(oi.quantity * oi.price), 0) as revenue
FROM products p
JOIN order_items oi ON p.id = oi.product_id  
JOIN orders o ON oi.order_id = o.id
WHERE o.status != 'CANCELLED'
GROUP BY p.id, p.name
ORDER BY ordersCount DESC, revenue DESC
LIMIT 5;
```

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º:

```sql
SELECT 
    status,
    COUNT(*) as count
FROM orders 
GROUP BY status;
```

## ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã:**
- **200** - –£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏
- **401** - –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–µ—Ç/–Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω)
- **403** - –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω (–Ω–µ –∞–¥–º–∏–Ω)
- **500** - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

**–§–æ—Ä–º–∞—Ç –æ—à–∏–±–∫–∏:**

```json
{
  "status": 401,
  "message": "–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",
  "timestamp": 1672531200000
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ –¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–ª—É—á–∞—è:

```bash
curl -X GET "https://debaganov-pizzanat-0177.twc1.net/api/v1/admin/stats" \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiJ9..." \
  -H "Content-Type: application/json"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: HTTP 200 + JSON —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

### ‚ùå –¢–µ—Å—Ç –±–µ–∑ —Ç–æ–∫–µ–Ω–∞:

```bash
curl -X GET "https://debaganov-pizzanat-0177.twc1.net/api/v1/admin/stats"
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: HTTP 401 + —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- ‚úÖ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTTP 200 –¥–ª—è –≤–∞–ª–∏–¥–Ω–æ–≥–æ –∞–¥–º–∏–Ω—Å–∫–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –í—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –æ—Ç–≤–µ—Ç–µ
- ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –ë–î
- ‚úÖ –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞ < 2 —Å–µ–∫—É–Ω–¥

## üìû –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**: –ì–æ—Ç–æ–≤–æ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏!
- **–¢–µ–∫—É—â–∏–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –∞–¥–º–∏–Ω—Å–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**:
  - ‚úÖ `GET /api/v1/admin/orders` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
  - ‚ùå `GET /api/v1/admin/stats` - –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –¢–ó**: 19 –¥–µ–∫–∞–±—Ä—è 2024  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å**: Backend –∫–æ–º–∞–Ω–¥–∞ PizzaNat 