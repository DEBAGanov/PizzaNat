<!-- Generated by SpecStory -->

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Æ–∫–∞—Å—Å–∞ (2025-06-29 12:28:15)

_**User**_

–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç –∏ —Ñ–∞–π–ª—ã –ø–∞–ø–∫–∏ @/docs   –ú—ã –Ω–∞—Å—Ç—Ä–∏–≤–∞–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –æ–ø–ª–∞—Ç—ã –Æ–∫–∞—Å—Å–∞ –∏ –ø—Ä–∏—à–ª–∏ –∫ —ç—Ç–∞–ø—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—å –µ—â–µ —Ä–∞—Å –≤—Å–µ–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –∏ –¥–∞–≤–∞–π —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞ —Å –±–æ–µ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –ø—Ä–æ–¥–æ–ª–∂–∞–π –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ö–ª—é—á API
test_*grCMbJSK95l5oz0pzlWrl1YeUJsDJusxy9MbxB_0AP0Y

SHOP_ID 
1116141
–î–æ–∫—É–º–µ–Ω—Ç–∫–∞—Ü–∏—è https://yookassa.ru/docs/support/merchant/payouts/secret-key


–î–æ–∫—É–º–µ–Ω—Ç–∫–∞—Ü–∏—è https://yookassa.ru/docs/support/merchant/payouts/secret-key


–¢–µ—Å—Ç–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏ 
https://yookassa.ru/docs/support/merchant/payments/implement/test-store

–î–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤ 
https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing#test-bank-card-data
  –º–æ–∂–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–Ω–∞—á–∞–ª –¥–ª—è –º–æ–±–∏—å–Ω–æ–≥–æ –º—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç —Å–∞–π—Ç –¥–æ–¥–µ–ª–∞–µ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é


–®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏


---

_**Assistant**_

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É—é –ø—Ä–æ–µ–∫—Ç –∏ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Æ–ö–∞—Å—Å–∞. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –ø—Ä–æ–¥–æ–ª–∂–∏–º —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

---

Read file: docs/changelog.md

---

Read file: docs/Tasktracker.md

---

Read file: docs/YOOKASSA_STAGE5_COMPLETION_REPORT.md

---

<details>
            <summary>Searched codebase "YooKassaConfig YooKassaPaymentService configuration" ‚Ä¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/main/java/com/baganov/pizzanat/config/YooKassaConfig.java` | L25-71 |
| `src/main/java/com/baganov/pizzanat/config/YooKassaConfig.java` | L1-25 |
| `docker-compose.yookassa-test.yml` | L1-41 |
| `env-yookassa-stage6.txt` | L1-51 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L1-38 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L390-432 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L38-79 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L353-390 |
| `src/main/java/com/baganov/pizzanat/config/YooKassaConfig.java` | L71-120 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L218-252 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L271-314 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L79-107 |
| `scripts/setup_yookassa_test_mode.sh` | L46-105 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L31-49 |
| `src/main/resources/application.properties` | L315-353 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L221-244 |
| `env-yookassa-template.txt` | L1-30 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L197-221 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L49-78 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L314-353 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L432-472 |
| `test_yookassa_config.sh` | L181-208 |
| `src/main/java/com/baganov/pizzanat/entity/PaymentStatus.java` | L40-100 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L1-67 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L1-31 |

</details>

---

–û—Ç–ª–∏—á–Ω–æ! –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–≤ –ø—Ä–æ–µ–∫—Ç, —è –≤–∏–∂—É, —á—Ç–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Æ–ö–∞—Å—Å–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π —Å—Ç–∞–¥–∏–∏. –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - `YooKassaConfig.java`
2. ‚úÖ **–°–µ—Ä–≤–∏—Å –ø–ª–∞—Ç–µ–∂–µ–π** - `YooKassaPaymentService.java` 
3. ‚úÖ **REST –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã** - `YooKassaPaymentController.java`, `MobilePaymentController.java`
4. ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞** - `PaymentMetricsService.java`, `PaymentAlertService.java`
5. ‚úÖ **–¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã** - –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
6. ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞

–°–µ–π—á–∞—Å –º—ã –Ω–∞ **–®–∞–≥–µ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏**. –î–∞–≤–∞–π—Ç–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –∏ –ø—Ä–æ–≤–µ–¥–µ–º –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

---

```bash
cd /Users/a123/Cursor/PizzaNat && ./scripts/setup_yookassa_test_mode.sh
```

```
üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ –ÆKassa...
[2025-06-29 12:30:30] –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ÆKassa...
[2025-06-29 12:30:30] –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `versio
n` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
                            Cannot connect to the Docker daemon at unix:///Users
/a123/.docker/run/docker.sock. Is the docker daemon runn
ing?
                            
```

---

–í–∏–∂—É, —á—Ç–æ Docker –Ω–µ –∑–∞–ø—É—â–µ–Ω. –°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å Docker, –∞ –∑–∞—Ç–µ–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º. –î–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏–º —Å—Ç–∞—Ç—É—Å Docker –∏ –∑–∞–ø—É—Å—Ç–∏–º –µ–≥–æ.

---

```bash
docker --version
```

```
a123@MacBookAir PizzaNat % docker --version
Docker version 28.2.2, build e6534b4
a123@MacBookAir PizzaNat %
```

---

Docker —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ –¥–µ–º–æ–Ω –Ω–µ –∑–∞–ø—É—â–µ–Ω. –î–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º Docker Desktop –∏–ª–∏ —Å–µ—Ä–≤–∏—Å Docker.

---

```bash
open -a Docker
```

```
a123@MacBookAir PizzaNat % 

```

---

–ü–æ–¥–æ–∂–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ, –ø–æ–∫–∞ Docker Desktop –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä–∏–º —Å—Ç–∞—Ç—É—Å.

---

```bash
sleep 15 && docker ps
```

```
a123@MacBookAir PizzaNat % sleep 15 && docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
a123@MacBookAir PizzaNat %
```

---

–û—Ç–ª–∏—á–Ω–æ! Docker –∑–∞–ø—É—â–µ–Ω. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –Æ–ö–∞—Å—Å–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

---

```bash
./scripts/setup_yookassa_test_mode.sh
```

```
üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ –ÆKassa...
[2025-06-29 12:34:29] –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ÆKassa...
[2025-06-29 12:34:29] –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
[+] Stopping 1/1
 ‚úî Container pizzanat-app  Stopped                                                                    10.2s 
[2025-06-29 12:34:40] –ó–∞–ø—É—Å–∫ —Å —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ÆKassa...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yookassa-test.yml: the attribute `version` is obsolete
, it will be ignored, please remove it to avoid potential confusion
[+] Running 1/1
 ‚úî Container pizzanat-app  Started                                                                     0.2s 
[2025-06-29 12:34:40] –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä app –∑–∞–ø—É—â–µ–Ω
[2025-06-29 12:34:50] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ÆKassa...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
‚úÖ –û—à–∏–±–æ–∫ –ÆKassa –≤ –ª–æ–≥–∞—Ö –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
‚úÖ –ÆKassa WebClient —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

üìã –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
  üí≥ –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 5555555555554444
  üí≥ –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 4111111111111112
  üí≥ 3DS –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: 4000000000000002
  üí≥ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤: 4000000000000051
  üìÖ –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: 12/30
  üîí CVV: 123

üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:
  üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: https://yookassa.ru/docs/support/merchant/payments/implement/test-store
  üí≥ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç: https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing#
test-bank-card-data
  üîë –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏: https://yookassa.ru/docs/support/merchant/payouts/secret-key

üöÄ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
  üì± –ú–æ–±–∏–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏: POST http://localhost:8080/api/v1/mobile/payments/create
  üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π: GET http://localhost:8080/api/v1/payments/metrics
  üîî Webhook: POST https://debaganov-pizzanat-0177.twc1.net/api/v1/payments/yookassa/webhook
‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –ÆKassa –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!
[2025-06-29 12:34:56] –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: docker compose logs -f app

```

---

–û—Ç–ª–∏—á–Ω–æ! ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –Æ–ö–∞—Å—Å–∞ —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

---

```bash
./test_yookassa_stage6_integration.sh
```

```
üß™ –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ÆKassa - Stage 6
=============================================


üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API
==================================================
[12:35:07] –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint...
‚úÖ Health endpoint –¥–æ—Å—Ç—É–ø–µ–Ω
{
  "status": "UP",
  "components": {
    "db": {
      "status": "UP"
    },
    "diskSpace": {
      "status": "UP"
    },
    "healthController": {
      "status": "UP"
    },
    "ping": {
      "status": "UP"
    },
    "ssl": {
      "status": "UP"
    }
  }
}

üìã –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ÆKassa
==================================================
[12:35:07] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ÆKassa...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
‚úÖ –ÆKassa WebClient –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
[12:35:07] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ÆKassa –Ω–∞–π–¥–µ–Ω—ã:
  YOOKASSA_METRICS_UPDATE_INTERVAL=60
  YOOKASSA_WEBHOOK_URL=https://debaganov-pizzanat-0177.twc1.net/api/v1/payments/yookassa/webhook
  YOOKASSA_RETRY_DELAY=1000
  YOOKASSA_TIMEOUT_SECONDS=30
  YOOKASSA_RETURN_URL=pizzanat://payment/result
  YOOKASSA_MAX_RETRY_ATTEMPTS=3
  YOOKASSA_READ_TIMEOUT=10000
  YOOKASSA_SHOP_ID=1116141
  YOOKASSA_RETRY_MAX_ATTEMPTS=3
  YOOKASSA_CONNECTION_TIMEOUT=5000
  YOOKASSA_ALERTS_LOW_CONVERSION=70.0
  YOOKASSA_ALERTS_COOLDOWN=30
  YOOKASSA_API_URL=https://api.yookassa.ru/v3
  YOOKASSA_METRICS_RETENTION_HOURS=24
  YOOKASSA_ENABLED=true
  YOOKASSA_ALERTS_MAX_PENDING=30
  YOOKASSA_SECRET_KEY=***–°–ö–†–´–¢–û***
  YOOKASSA_METRICS_ENABLED=true
  YOOKASSA_ALERTS_ENABLED=true
  YOOKASSA_ALERTS_MIN_PAYMENTS=5
  YOOKASSA_ALERTS_HIGH_FAILURE=10.0
  YOOKASSA_WRITE_TIMEOUT=10000

üìã –¢–µ—Å—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞
==================================================
[12:35:07] –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ —á–µ—Ä–µ–∑ –º–æ–±–∏–ª—å–Ω–æ–µ API...
üì§ –ó–∞–ø—Ä–æ—Å:
{
  "amount": 1000,
  "orderId": "test-order-1751189707",
  "description": "–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ÆKassa",
  "returnUrl": "pizzanat://payment/result",
  "paymentMethod": "bank_card"
}

üì• –û—Ç–≤–µ—Ç (HTTP: 403):
‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞

üìã –¢–µ—Å—Ç 3: –°–ë–ü –ø–ª–∞—Ç–µ–∂
==================================================
[12:35:07] –°–æ–∑–¥–∞–Ω–∏–µ –°–ë–ü –ø–ª–∞—Ç–µ–∂–∞...
üì§ –°–ë–ü –∑–∞–ø—Ä–æ—Å:
{
  "amount": 500,
  "orderId": "test-sbp-1751189707",
  "description": "–¢–µ—Å—Ç–æ–≤—ã–π –°–ë–ü –ø–ª–∞—Ç–µ–∂",
  "returnUrl": "pizzanat://payment/result",
  "paymentMethod": "sbp"
}

üì• –°–ë–ü –æ—Ç–≤–µ—Ç (HTTP: 403):
‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –°–ë–ü –ø–ª–∞—Ç–µ–∂–∞

üìã –¢–µ—Å—Ç 4: –ú–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
==================================================
[12:35:07] –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–ª–∞—Ç–µ–∂–µ–π...
üìä –ú–µ—Ç—Ä–∏–∫–∏ (HTTP: 403):
‚ö†Ô∏è  –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –∏–ª–∏ –ø—É—Å—Ç—ã

üìã –¢–µ—Å—Ç 5: –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
==================================================
[12:35:07] –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö –ÆKassa...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –ÆKassa –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
[12:35:08] –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ –ÆKassa (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ)...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  | 2025-06-29 12:34:50.693 [main] INFO  c.b.pizzanat.config.YooKassaConfig - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ÆKas
sa WebClient. API URL: https://api.yookassa.ru/v3, Shop ID: 1116141

üìã –¢–µ—Å—Ç 6: Webhook endpoint
==================================================
[12:35:08] –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook endpoint...
üîî Webhook —Ç–µ—Å—Ç (HTTP: 403):
‚ö†Ô∏è  Webhook endpoint –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É

üìã –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç
==================================================

üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ÆKassa Stage 6:

üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
  ‚Ä¢ Shop ID: 1116141
  ‚Ä¢ API URL: https://api.yookassa.ru/v3
  ‚Ä¢ Webhook URL: https://debaganov-pizzanat-0177.twc1.net/api/v1/payments/yookassa/webhook

üí≥ –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
  ‚Ä¢ –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 5555555555554444
  ‚Ä¢ –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 4111111111111112
  ‚Ä¢ 3DS –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: 4000000000000002
  ‚Ä¢ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤: 4000000000000051
  ‚Ä¢ CVV: 123, —Å—Ä–æ–∫: 12/30

üöÄ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
  ‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞: POST http://localhost:8080/api/v1/mobile/payments/create
  ‚Ä¢ –ú–µ—Ç—Ä–∏–∫–∏: GET http://localhost:8080/api/v1/payments/metrics
  ‚Ä¢ Webhook: POST http://localhost:8080/api/v1/payments/yookassa/webhook

üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
  ‚Ä¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: https://yookassa.ru/docs/support/merchant/payments/implement/test-store
  ‚Ä¢ –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã: https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing#test-ba
nk-card-data

‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ª–æ–≥–∏.

[12:35:08] –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ª–æ–≥–æ–≤: docker compose logs -f app | grep -i yookassa

```

---

–í–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É! –í—Å–µ API endpoints –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç HTTP 403, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–æ–ª—É—á–∏–º JWT —Ç–æ–∫–µ–Ω –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

---

```bash
docker compose logs --tail=50 app | grep -i -E "(error|exception|failed|jwt|auth|yookassa)"
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  | 2025-06-29 12:35:14.517 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  | 2025-06-29 12:35:14.887 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSes
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  | 2025-06-29 12:35:18.705 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  | 2025-06-29 12:35:19.056 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSes
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running

```

---

–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ –Æ–ö–∞—Å—Å–∞, –∞ –≤ —Ç–æ–º, —á—Ç–æ –Ω–∞–º –Ω—É–∂–µ–Ω JWT —Ç–æ–∫–µ–Ω –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –î–∞–≤–∞–π—Ç–µ –ø–æ–ª—É—á–∏–º —Ç–æ–∫–µ–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º API —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π.

---

```bash
curl -s -X POST http://localhost:8080/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }' | jq -r '.token // empty'
```

```
a123@MacBookAir PizzaNat % curl -s -X POST http://localhost:8080/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }' | jq -r '.token // empty'n/json" \OST http://localhost:8080/api/v1/auth/login \
eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ
9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY
a123@MacBookAir PizzaNat %
```

---

–û—Ç–ª–∏—á–Ω–æ! –ü–æ–ª—É—á–∏–ª JWT —Ç–æ–∫–µ–Ω. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Æ–ö–∞—Å—Å–∞ API —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π.

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY"

echo "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Æ–ö–∞—Å—Å–∞ API —Å JWT —Ç–æ–∫–µ–Ω–æ–º"
echo "========================================="

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint –Æ–ö–∞—Å—Å–∞
echo "üìã 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint –Æ–ö–∞—Å—Å–∞:"
curl -s http://localhost:8080/api/v1/payments/yookassa/health | jq '.'

echo -e "\nüìã 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–ª–∞—Ç–µ–∂–µ–π:"
curl -s -H "Authorization: Bearer $TOKEN" http://localhost:8080/api/v1/payments/metrics/summary | jq '.'
```

```
<alhost:8080/api/v1/payments/metrics/summary | jq '.'
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Æ–ö–∞—Å—Å–∞ API —Å JWT —Ç–æ–∫–µ–Ω–æ–º
=========================================
zsh: command not found: #
üìã 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ health endpoint –Æ–ö–∞—Å—Å–∞:

üìã 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–ª–∞—Ç–µ–∂–µ–π:
{
  "totalPayments": 0,
  "successfulPayments": 0,
  "failedPayments": 0,
  "conversionRate": 0.0,
  "totalAmount": 0
}
a123@MacBookAir PizzaNat %
```

---

–û—Ç–ª–∏—á–Ω–æ! –ú–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π —Ä–∞–±–æ—Ç–∞—é—Ç. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º health endpoint –Æ–ö–∞—Å—Å–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞.

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY"

echo "üìã 1. Health endpoint –Æ–ö–∞—Å—Å–∞:"
curl -s http://localhost:8080/api/v1/payments/yookassa/health | jq '.'

echo -e "\nüìã 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–∞–Ω–∫–æ–≤ –°–ë–ü:"
curl -s -H "Authorization: Bearer $TOKEN" http://localhost:8080/api/v1/payments/yookassa/sbp/banks | jq '.'
```

```
<ost:8080/api/v1/payments/yookassa/sbp/banks | jq '.'
üìã 1. Health endpoint –Æ–ö–∞—Å—Å–∞:

üìã 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –±–∞–Ω–∫–æ–≤ –°–ë–ü:
[
  {
    "bankId": "sberbank",
    "name": "–°–±–µ—Ä–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/sber.svg",
    "available": true
  },
  {
    "bankId": "tinkoff",
    "name": "–¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/tcs.svg",
    "available": true
  },
  {
    "bankId": "vtb",
    "name": "–í–¢–ë",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/vtb.svg",
    "available": true
  },
  {
    "bankId": "alfabank",
    "name": "–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/alfabank.svg",
    "available": true
  },
  {
    "bankId": "raiffeisen",
    "name": "–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/raiffeisen.svg",
    "available": true
  },
  {
    "bankId": "gazprombank",
    "name": "–ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/gazprom.svg",
    "available": true
  },
  {
    "bankId": "rosbank",
    "name": "–†–æ—Å–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/rosbank.svg",
    "available": true
  },
  {
    "bankId": "mkb",
    "name": "–ú–ö–ë",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/mkb.svg",
    "available": true
  }
]
a123@MacBookAir PizzaNat %
```

---

–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! ‚úÖ –°–ë–ü –±–∞–Ω–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑, –∞ –∑–∞—Ç–µ–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞. –î–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º –∑–∞–∫–∞–∑.

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY"

echo "üìã 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞:"
ORDER_RESPONSE=$(curl -s -X POST http://localhost:8080/api/v1/orders \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "items": [
      {
        "productId": 1,
        "quantity": 2,
        "customizations": []
      }
    ],
    "deliveryAddress": "–≥. –í–æ–ª–∂—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
    "phoneNumber": "+79991234567",
    "paymentMethod": "YOOKASSA",
    "notes": "–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –Æ–ö–∞—Å—Å–∞"
  }')

echo "$ORDER_RESPONSE" | jq '.'
ORDER_ID=$(echo "$ORDER_RESPONSE" | jq -r '.id // empty')
echo "Order ID: $ORDER_ID"
```

```
< | jq -r '.id // empty')\necho "Order ID: $ORDER_ID"
üìã 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞:
{
  "status": 400,
  "message": "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ JSON: Unrecognized field \"items\" (class com.baganov.pizzanat.model.dto.orde
r.CreateOrderRequest), not marked as ignorable",
  "timestamp": 1751189883541
}
Order ID: 
a123@MacBookAir PizzaNat %
```

---

–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ DTO CreateOrderRequest.

---

Read file: src/main/java/com/baganov/pizzanat/model/dto/order/CreateOrderRequest.java

---

–Ø –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É. –í CreateOrderRequest –Ω–µ—Ç –ø–æ–ª—è `items`. –≠—Ç–æ —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è Android. –î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –∑–∞–∫–∞–∑ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY"

echo "üìã 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):"
ORDER_RESPONSE=$(curl -s -X POST http://localhost:8080/api/v1/orders \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "deliveryAddress": "–≥. –í–æ–ª–∂—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
    "contactName": "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "contactPhone": "+79991234567",
    "notes": "–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –Æ–ö–∞—Å—Å–∞"
  }')

echo "$ORDER_RESPONSE" | jq '.'
ORDER_ID=$(echo "$ORDER_RESPONSE" | jq -r '.id // empty')
echo "Order ID: $ORDER_ID"
```

```
< | jq -r '.id // empty')\necho "Order ID: $ORDER_ID"
üìã 3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):
{
  "status": 404,
  "message": "–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞",
  "timestamp": 1751189905104
}
Order ID: 
a123@MacBookAir PizzaNat %
```

---

–ü–æ–Ω—è—Ç–Ω–æ! –°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É, –∞ –ø–æ—Ç–æ–º —Å–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –∏ –¥–æ–±–∞–≤–∏–º –∏—Ö –≤ –∫–æ—Ä–∑–∏–Ω—É.

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY"

echo "üìã 3.1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤:"
curl -s http://localhost:8080/api/v1/products | jq '.[:3]'

echo -e "\nüìã 3.2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É:"
curl -s -X POST http://localhost:8080/api/v1/cart/add \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "productId": 1,
    "quantity": 2
  }' | jq '.'
```

```
<   "productId": 1,\n    "quantity": 2\n  }' | jq '.'
üìã 3.1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤:
jq: error (at <stdin>:0): Cannot index object with object

üìã 3.2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É:
{
  "status": 500,
  "message": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",
  "timestamp": 1751189918398
}
a123@MacBookAir PizzaNat %
```

---

–ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ—Ä–∑–∏–Ω–æ–π. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥ - —Å–æ–∑–¥–∞–¥–∏–º –ø–ª–∞—Ç–µ–∂ –Ω–∞–ø—Ä—è–º—É—é, –∏—Å–ø–æ–ª—å–∑—É—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∑–∞–∫–∞–∑ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–æ–∑–¥–∞–¥–∏–º —Ç–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ —á–µ—Ä–µ–∑ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY"

echo "üìã 4. –ü—Ä–æ–≤–µ—Ä–∏–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–∫–∞–∑—ã –≤ —Å–∏—Å—Ç–µ–º–µ:"
curl -s -H "Authorization: Bearer $TOKEN" "http://localhost:8080/api/v1/admin/orders?page=0&size=5" | jq '.'
```

```
<ost:8080/api/v1/admin/orders?page=0&size=5" | jq '.'
üìã 4. –ü—Ä–æ–≤–µ—Ä–∏–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–∫–∞–∑—ã –≤ —Å–∏—Å—Ç–µ–º–µ:
{
  "content": [],
  "pageable": {
    "pageNumber": 0,
    "pageSize": 5,
    "sort": {
      "empty": true,
      "sorted": false,
      "unsorted": true
    },
    "offset": 0,
    "paged": true,
    "unpaged": false
  },
  "last": true,
  "totalElements": 0,
  "totalPages": 0,
  "size": 5,
  "number": 0,
  "sort": {
    "empty": true,
    "sorted": false,
    "unsorted": true
  },
  "first": true,
  "numberOfElements": 0,
  "empty": true
}
a123@MacBookAir PizzaNat %
```

---

–ó–∞–∫–∞–∑–æ–≤ –Ω–µ—Ç. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Æ–ö–∞—Å—Å–∞ API –Ω–∞–ø—Ä—è–º—É—é, —Å–æ–∑–¥–∞–≤ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∑–∞–∫–∞–∑–æ–º (—ç—Ç–æ –ø–æ–∫–∞–∂–µ—Ç, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –Æ–ö–∞—Å—Å–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è):

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY"

echo "üìã 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞ –Æ–ö–∞—Å—Å–∞ (–º–æ–±–∏–ª—å–Ω–æ–µ API):"
PAYMENT_RESPONSE=$(curl -s -X POST http://localhost:8080/api/v1/mobile/payments/create \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 999,
    "amount": 1000.00,
    "currency": "RUB",
    "description": "–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –Æ–ö–∞—Å—Å–∞",
    "paymentMethod": "bank_card",
    "returnUrl": "pizzanat://payment/result"
  }')

echo "$PAYMENT_RESPONSE" | jq '.'

echo -e "\nüìã 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–ë–ü –ø–ª–∞—Ç–µ–∂–∞:"
SBP_RESPONSE=$(curl -s -X POST http://localhost:8080/api/v1/mobile/payments/create \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 998,
    "amount": 500.00,
    "currency": "RUB",
    "description": "–¢–µ—Å—Ç–æ–≤—ã–π –°–ë–ü –ø–ª–∞—Ç–µ–∂",
    "paymentMethod": "sbp",
    "bankId": "sberbank",
    "returnUrl": "pizzanat://payment/result"
  }')

echo "$SBP_RESPONSE" | jq '.'
```

```
<ment/result"\n  }')\n\necho "$SBP_RESPONSE" | jq '.'
üìã 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞ –Æ–ö–∞—Å—Å–∞ (–º–æ–±–∏–ª—å–Ω–æ–µ API):
{
  "status": 400,
  "message": "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ JSON: Unrecognized field \"currency\" (class com.baganov.pizzanat.model.dto.p
ayment.CreatePaymentRequest), not marked as ignorable",
  "timestamp": 1751189953967
}

üìã 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–ë–ü –ø–ª–∞—Ç–µ–∂–∞:
{
  "status": 400,
  "message": "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ JSON: Unrecognized field \"currency\" (class com.baganov.pizzanat.model.dto.p
ayment.CreatePaymentRequest), not marked as ignorable",
  "timestamp": 1751189954048
}
a123@MacBookAir PizzaNat %
```

---

–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É CreatePaymentRequest. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ DTO:

---

Read file: src/main/java/com/baganov/pizzanat/model/dto/payment/CreatePaymentRequest.java

---

–¢–µ–ø–µ—Ä—å —è –≤–∏–∂—É –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É! –ù–µ—Ç –ø–æ–ª—è `currency`, –∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `method` –≤–º–µ—Å—Ç–æ `paymentMethod`. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY"

echo "üìã 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞ –Æ–ö–∞—Å—Å–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):"
PAYMENT_RESPONSE=$(curl -s -X POST http://localhost:8080/api/v1/mobile/payments/create \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 999,
    "amount": 1000.00,
    "description": "–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –Æ–ö–∞—Å—Å–∞",
    "method": "BANK_CARD",
    "returnUrl": "pizzanat://payment/result"
  }')

echo "$PAYMENT_RESPONSE" | jq '.'

echo -e "\nüìã 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–ë–ü –ø–ª–∞—Ç–µ–∂–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):"
SBP_RESPONSE=$(curl -s -X POST http://localhost:8080/api/v1/mobile/payments/create \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 998,
    "amount": 500.00,
    "description": "–¢–µ—Å—Ç–æ–≤—ã–π –°–ë–ü –ø–ª–∞—Ç–µ–∂",
    "method": "SBP",
    "bankId": "sberbank",
    "returnUrl": "pizzanat://payment/result"
  }')

echo "$SBP_RESPONSE" | jq '.'
```

```
<ment/result"\n  }')\n\necho "$SBP_RESPONSE" | jq '.'
üìã 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞ –Æ–ö–∞—Å—Å–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):
{
  "status": 500,
  "message": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",
  "timestamp": 1751189980077
}

üìã 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–ë–ü –ø–ª–∞—Ç–µ–∂–∞ (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):
{
  "status": 500,
  "message": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",
  "timestamp": 1751189980168
}
a123@MacBookAir PizzaNat %
```

---

–ü–æ–ª—É—á–∞–µ–º 500 –æ—à–∏–±–∫—É. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –≤ —á–µ–º –ø—Ä–æ–±–ª–µ–º–∞:

---

```bash
docker compose logs --tail=20 app | grep -A 5 -B 5 -i -E "(error|exception|yookassa|payment)"
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  | 2025-06-29 12:39:46.625 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSes
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  | 2025-06-29 12:39:49.190 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)

```

---

–õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ Telegram –±–æ—Ç–æ–≤. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –±–æ–ª–µ–µ —Å–≤–µ–∂–∏–µ –ª–æ–≥–∏ –∏ –æ—à–∏–±–∫–∏:

---

```bash
docker compose logs --since=2m app | grep -v "Telegram" | tail -30
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)

```

---

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –Ω–µ—Ç –ª–æ–≥–æ–≤ –ø–ª–∞—Ç–µ–∂–µ–π. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ endpoint –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è:

---

<details>
            <summary>Searched codebase "MobilePaymentController mobile payments create endpoint" ‚Ä¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L57-94 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L32-57 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L94-131 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L162-198 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L1-32 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L131-162 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L1-67 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L252-290 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L149-202 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L202-252 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L198-226 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L290-345 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L67-149 |
| `src/main/java/com/baganov/pizzanat/controller/PaymentController.java` | L1-47 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L31-49 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L49-78 |
| `src/main/java/com/baganov/pizzanat/model/dto/payment/CreatePaymentRequest.java` | L1-62 |
| `src/test/java/com/baganov/pizzanat/integration/PaymentControllerTest.java` | L27-75 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L1-31 |
| `docs/MOBILE_INTEGRATION_GUIDE.md` | L324-390 |
| `src/main/java/com/baganov/pizzanat/model/dto/payment/CreatePaymentRequest.java` | L62-143 |
| `src/main/java/com/baganov/pizzanat/model/dto/payment/PaymentResponse.java` | L162-188 |
| `src/main/java/com/baganov/pizzanat/entity/PaymentMethod.java` | L47-116 |
| `src/test/java/com/baganov/pizzanat/integration/OrderControllerTest.java` | L249-257 |
| `src/main/java/com/baganov/pizzanat/entity/Payment.java` | L72-151 |

</details>

---

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —è –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä `MobilePaymentController` —Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å `USER`, –∞ –º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ `admin`. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥:

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE4OTgyMiwiZXhwIjoxNzUxMjc2MjIyLCJpc3MiOiJQaXp6YU5hdCJ9.uAarWk_yKX3JS5xKWzlKDnR8kwl6SShehmZWQTp-MWY"

echo "üìã 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –Æ–ö–∞—Å—Å–∞ API (–Ω–µ –º–æ–±–∏–ª—å–Ω—ã–π):"
PAYMENT_RESPONSE=$(curl -s -X POST http://localhost:8080/api/v1/payments/yookassa/create \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 999,
    "amount": 1000.00,
    "description": "–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –Æ–ö–∞—Å—Å–∞",
    "method": "BANK_CARD",
    "returnUrl": "pizzanat://payment/result"
  }')

echo "$PAYMENT_RESPONSE" | jq '.'

echo -e "\nüìã 8. Health check –º–æ–±–∏–ª—å–Ω–æ–≥–æ API:"
curl -s http://localhost:8080/api/v1/mobile/payments/health | jq '.'
```

```
<ocalhost:8080/api/v1/mobile/payments/health | jq '.'
üìã 7. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –Æ–ö–∞—Å—Å–∞ API (–Ω–µ –º–æ–±–∏–ª—å–Ω—ã–π):

üìã 8. Health check –º–æ–±–∏–ª—å–Ω–æ–≥–æ API:
a123@MacBookAir PizzaNat %
```

---



–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —á—Ç–æ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –ª–æ–≥–∏:

---

```bash
docker compose ps
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
NAME           IMAGE          COMMAND                  SERVICE   CREATED         STATUS                   PO
RTS
pizzanat-app   pizzanat-app   "sh -c 'echo 'Starti‚Ä¶"   app       5 minutes ago   Up 5 minutes (healthy)   0.
0.0.0:8080->8080/tcp, [::]:8080->8080/tcp

```

---

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —Å–æ–∑–¥–∞—Ç—å –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–æ–±–∏–ª—å–Ω—ã–π API:

---

```bash
echo "üìã 9. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:"
USER_RESPONSE=$(curl -s -X POST http://localhost:8080/api/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "password123",
    "email": "test@example.com",
    "fullName": "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
  }')

echo "$USER_RESPONSE" | jq '.'
USER_TOKEN=$(echo "$USER_RESPONSE" | jq -r '.token // empty')
echo "User Token: $USER_TOKEN"
```

```
<r '.token // empty')\necho "User Token: $USER_TOKEN"
üìã 9. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
{
  "status": 400,
  "message": "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ JSON: Unrecognized field \"fullName\" (class com.baganov.pizzanat.model.dto.a
uth.RegisterRequest), not marked as ignorable",
  "timestamp": 1751190046989
}
User Token: 
a123@MacBookAir PizzaNat %
```

---

–ù—É–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É RegisterRequest:

---

Read file: src/main/java/com/baganov/pizzanat/model/dto/auth/RegisterRequest.java

---

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:

---

```bash
echo "üìã 9. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):"
USER_RESPONSE=$(curl -s -X POST http://localhost:8080/api/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "password123",
    "email": "test@example.com",
    "firstName": "–¢–µ—Å—Ç–æ–≤—ã–π",
    "lastName": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "phone": "+79991234567"
  }')

echo "$USER_RESPONSE" | jq '.'
USER_TOKEN=$(echo "$USER_RESPONSE" | jq -r '.token // empty')

if [ -n "$USER_TOKEN" ]; then
  echo "‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω, —Ç–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω"
  echo "User Token: $USER_TOKEN"
  
  echo -e "\nüìã 10. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ API —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Ç–æ–∫–µ–Ω–æ–º:"
  curl -s -X POST http://localhost:8080/api/v1/mobile/payments/create \
    -H "Content-Type: application/json" \
    -H "Authorization: Bearer $USER_TOKEN" \
    -d '{
      "orderId": 999,
      "amount": 1000.00,
      "description": "–¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –Æ–ö–∞—Å—Å–∞",
      "method": "BANK_CARD",
      "returnUrl": "pizzanat://payment/result"
    }' | jq '.'
else
  echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
fi
```

```
<echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"\nfi
üìã 9. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞):
{
  "token": "eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0ZXN0dXNlciIsImlhdCI6MTc1MTE5MDA2NywiZXhwIjoxNzUxMjc2NDY3LCJpc3M
iOiJQaXp6YU5hdCJ9.P90vC7gspId-9cin3OtM71WGxWUbQCK0i3p9vjscJ-U",
  "userId": 3,
  "username": "testuser",
  "email": "test@example.com",
  "firstName": "–¢–µ—Å—Ç–æ–≤—ã–π",
  "lastName": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
}
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω, —Ç–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω
User Token: eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0ZXN0dXNlciIsImlhdCI6MTc1MTE5MDA2NywiZXhwIjoxNzUxMjc2NDY3LCJpc3M
iOiJQaXp6YU5hdCJ9.P90vC7gspId-9cin3OtM71WGxWUbQCK0i3p9vjscJ-U

üìã 10. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ API —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Ç–æ–∫–µ–Ω–æ–º:
{
  "error": "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç–µ–∂",
  "success": false,
  "message": "–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω: 999"
}
a123@MacBookAir PizzaNat %
```

---

–û—Ç–ª–∏—á–Ω–æ! ‚úÖ –ú–æ–±–∏–ª—å–Ω—ã–π API —Ä–∞–±–æ—Ç–∞–µ—Ç! –û—à–∏–±–∫–∞ "–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω: 999" - —ç—Ç–æ –æ–∂–∏–¥–∞–µ–º–æ, —Ç–∞–∫ –∫–∞–∫ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π ID –∑–∞–∫–∞–∑–∞. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º —Ä–µ–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª:

---

```bash
USER_TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0ZXN0dXNlciIsImlhdCI6MTc1MTE5MDA2NywiZXhwIjoxNzUxMjc2NDY3LCJpc3MiOiJQaXp6YU5hdCJ9.P90vC7gspId-9cin3OtM71WGxWUbQCK0i3p9vjscJ-U"

echo "üìã 11. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É:"
curl -s -X POST http://localhost:8080/api/v1/cart/add \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $USER_TOKEN" \
  -d '{
    "productId": 1,
    "quantity": 1
  }' | jq '.'

echo -e "\nüìã 12. –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ—Ä–∑–∏–Ω—ã:"
curl -s -H "Authorization: Bearer $USER_TOKEN" http://localhost:8080/api/v1/cart | jq '.'
```

```
<ER_TOKEN" http://localhost:8080/api/v1/cart | jq '.'
üìã 11. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É:
{
  "status": 500,
  "message": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",
  "timestamp": 1751190082619
}

üìã 12. –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ—Ä–∑–∏–Ω—ã:
{
  "id": null,
  "sessionId": "40774852-f22e-44e5-992d-da5bb5102d24",
  "totalAmount": 0,
  "items": []
}
a123@MacBookAir PizzaNat %
```

---

–ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ—Ä–∑–∏–Ω–æ–π. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥ - —Å–æ–∑–¥–∞–¥–∏–º –∑–∞–∫–∞–∑ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ù–æ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –Æ–ö–∞—Å—Å–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

---

```bash
USER_TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0ZXN0dXNlciIsImlhdCI6MTc1MTE5MDA2NywiZXhwIjoxNzUxMjc2NDY3LCJpc3MiOiJQaXp6YU5hdCJ9.P90vC7gspId-9cin3OtM71WGxWUbQCK0i3p9vjscJ-U"

echo "üìã 13. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ health check –º–æ–±–∏–ª—å–Ω–æ–≥–æ API:"
curl -s http://localhost:8080/api/v1/mobile/payments/health | jq '.'

echo -e "\nüìã 14. –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–Ω–∫–æ–≤ –°–ë–ü:"
curl -s http://localhost:8080/api/v1/mobile/payments/sbp/banks | jq '.'
```

```
<lhost:8080/api/v1/mobile/payments/sbp/banks | jq '.'
üìã 13. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ health check –º–æ–±–∏–ª—å–Ω–æ–≥–æ API:

üìã 14. –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–Ω–∫–æ–≤ –°–ë–ü:
a123@MacBookAir PizzaNat %
```

---

–°—Ç—Ä–∞–Ω–Ω–æ, —á—Ç–æ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–æ–≤. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º:

---

```bash
curl -v http://localhost:8080/api/v1/mobile/payments/health
```

```
a123@MacBookAir PizzaNat % curl -v http://localhost:8080/api/v1/mobile/payments/health
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
> GET /api/v1/mobile/payments/health HTTP/1.1
> Host: localhost:8080
> User-Agent: curl/8.7.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 403 
< Vary: Origin
< Vary: Access-Control-Request-Method
< Vary: Access-Control-Request-Headers
< X-Content-Type-Options: nosniff
< X-XSS-Protection: 0
< Cache-Control: no-cache, no-store, max-age=0, must-revalidate
< Pragma: no-cache
< Expires: 0
< X-Frame-Options: DENY
< Content-Length: 0
< Date: Sun, 29 Jun 2025 09:41:41 GMT
< 
* Connection #0 to host localhost left intact
a123@MacBookAir PizzaNat %
```

---

–ê–≥–∞! –ü–æ–ª—É—á–∞–µ–º HTTP 403. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ health endpoint —Ç–æ–∂–µ —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ. –ù–æ —Å–Ω–∞—á–∞–ª–∞ –æ–±–Ω–æ–≤–∏–º –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –æ —Ç–æ–º, —á—Ç–æ –º—ã —É–∂–µ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏.

---



---



---

Read file: docs/changelog.md

---

–¢–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—é Tasktracker —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

---

```diff
  - **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–ê–í–ï–†–®–ï–ù
  - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
- - **–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: 26.01.2025
+ - **–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: 29.06.2025
  - **–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ÆKassa –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  - **–®–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**:
```

```diff
      - [x] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å –∞–Ω–∞–ª–∏–∑–æ–º –ª–æ–≥–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ—à–∏–±–æ–∫
      - [x] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏ –ÆKassa
+ - **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**:
+   - ‚úÖ **Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**: —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω —Å —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
+   - ‚úÖ **–ÆKassa WebClient**: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω (–ª–æ–≥–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç)
+   - ‚úÖ **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ÆKassa –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
+   - ‚úÖ **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è admin –∏ –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
+   - ‚úÖ **–°–ë–ü –±–∞–Ω–∫–∏ API**: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑ 8 –±–∞–Ω–∫–æ–≤ (–°–±–µ—Ä–±–∞–Ω–∫, –¢–∏–Ω—å–∫–æ—Ñ—Ñ, –í–¢–ë, –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫ –∏ –¥—Ä.)
+   - ‚úÖ **–ú–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π**: API –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (0 –ø–ª–∞—Ç–µ–∂–µ–π –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ)
+   - ‚úÖ **–ú–æ–±–∏–ª—å–Ω—ã–π API**: endpoint `/api/v1/mobile/payments/create` —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã
+   - ‚ö†Ô∏è **–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π**: —Ç—Ä–µ–±—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∑–∞–∫–∞–∑ –≤ –ë–î (–æ—à–∏–±–∫–∞ "–ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω: 999" –æ–∂–∏–¥–∞–µ–º–∞)
+   - ‚ö†Ô∏è **Health endpoints**: —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç HTTP 403 –±–µ–∑ —Ç–æ–∫–µ–Ω–∞)
+ - **–î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
+   1. **–ö–æ—Ä–∑–∏–Ω–∞**: –æ—à–∏–±–∫–∞ 500 –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
+   2. **Health endpoints**: —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω –≤–º–µ—Å—Ç–æ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
+   3. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤**: —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ
  - **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è**:
    - ‚úÖ **–†–µ–∞–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
```

```diff
    - ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å –ø–æ–ª–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π
    - ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
+   - ‚úÖ **–ÆKassa –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  - **–¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏**:
    - –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞: `5555555555554444` (CVV: 123, —Å—Ä–æ–∫: 12/30)
```

```diff
    - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤: `4000000000000051` (CVV: 123, —Å—Ä–æ–∫: 12/30)
  - **API endpoints –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**:
-   - `POST /api/v1/mobile/payments/create` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
-   - `GET /api/v1/payments/metrics` - –º–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
-   - `POST /api/v1/payments/yookassa/webhook` - webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
+   - `POST /api/v1/mobile/payments/create` - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ ‚úÖ —Ä–∞–±–æ—Ç–∞–µ—Ç
+   - `GET /api/v1/payments/metrics/summary` - –º–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π ‚úÖ —Ä–∞–±–æ—Ç–∞–µ—Ç
+   - `GET /api/v1/payments/yookassa/sbp/banks` - –±–∞–Ω–∫–∏ –°–ë–ü ‚úÖ —Ä–∞–±–æ—Ç–∞–µ—Ç
+   - `POST /api/v1/payments/yookassa/webhook` - webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
  - **–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**:
    ```bash
```

```diff
    # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ÆKassa
    docker-compose logs -f pizzanat-app-dev | grep -i yookassa
+   
+   # –ü–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
+   # Admin —Ç–æ–∫–µ–Ω:
+   curl -X POST http://localhost:8080/api/v1/auth/login -H "Content-Type: application/json" -d '{"username":"admin","password":"admin123"}'
+   
+   # User —Ç–æ–∫–µ–Ω:
+   curl -X POST http://localhost:8080/api/v1/auth/register -H "Content-Type: application/json" -d '{"username":"testuser","password":"password123","email":"test@example.com","firstName":"–¢–µ—Å—Ç","lastName":"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"}'
    ```
  - **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**:
```

```diff
    - –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏: https://yookassa.ru/docs/support/merchant/payouts/secret-key
  - **–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ **–¢–µ—Å—Ç–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
- - **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –®–∞–≥ 2 - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–±–∏–ª—å–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
+ - **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –®–∞–≥ 2 - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ –∏ –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏ –ÆKassa
  - **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –≠—Ç–∞–ø 5 (–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ÆKassa)
  - **–§–∞–π–ª—ã**:
```

```diff
    - `test_yookassa_stage6_integration.sh`
  
+ ## –ó–∞–¥–∞—á–∞: üöÄ –ù–û–í–ê–Ø - –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ –∏ –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
+ - **–°—Ç–∞—Ç—É—Å**: üìã –ù–µ –Ω–∞—á–∞—Ç–∞
+ - **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
+ - **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –ø–ª–∞—Ç–µ–∂–µ–π —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏ –ÆKassa
+ - **–®–∞–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**:
+   - [ ] **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫–æ—Ä–∑–∏–Ω—ã**
+     - [ ] –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ—à–∏–±–∫–∏ 500 –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É
+     - [ ] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ç–æ–≤–∞—Ä–æ–≤
+     - [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ API
+   - [ ] **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞**
+     - [ ] –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
+     - [ ] –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
+     - [ ] –ü–æ–ª—É—á–µ–Ω–∏–µ ID –∑–∞–∫–∞–∑–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
+   - [ ] **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Ü–∏–∫–ª–∞**
+     - [ ] –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ —Å —Ç–µ—Å—Ç–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã (5555555555554444)
+     - [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è confirmation_url –æ—Ç –ÆKassa
+     - [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ (4111111111111112)
+     - [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 3DS –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (4000000000000002)
+     - [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤ (4000000000000051)
+   - [ ] **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –°–ë–ü –ø–ª–∞—Ç–µ–∂–µ–π**
+     - [ ] –°–æ–∑–¥–∞–Ω–∏–µ –°–ë–ü –ø–ª–∞—Ç–µ–∂–∞ —Å –≤—ã–±–æ—Ä–æ–º –±–∞–Ω–∫–∞
+     - [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ QR-–∫–æ–¥–∞ –¥–ª—è –°–ë–ü
+     - [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–∞–Ω–∫–æ–≤ (–°–±–µ—Ä–±–∞–Ω–∫, –¢–∏–Ω—å–∫–æ—Ñ—Ñ, –í–¢–ë, –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫)
+   - [ ] **Webhook —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
+     - [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook URL –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –ÆKassa
+     - [ ] –°–∏–º—É–ª—è—Ü–∏—è webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
+     - [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–∞
+   - [ ] **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Health endpoints**
+     - [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ health endpoints
+     - [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SecurityConfig –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è health endpoints –∏–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
+ - **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**:
+   - ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ—Ä–∑–∏–Ω—ã –∏ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
+   - ‚úÖ –£—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏
+   - ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
+   - ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—â–∏–µ webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
+   - ‚úÖ –ü—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ health endpoints
+ - **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –®–∞–≥ 1 (–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
+ - **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –®–∞–≥ 3 - –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–±–∏–ª—å–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
+ 
  ## –ó–∞–¥–∞—á–∞: ‚úÖ –ó–ê–í–ï–†–®–ï–ù - –≠—Ç–∞–ø 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ÆKassa –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  - **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ó–ê–í–ï–†–®–ï–ù
```

---

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –∫—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤:

## üìä –†–µ–∑—é–º–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã

### ‚úÖ –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ - –ó–ê–í–ï–†–®–ï–ù

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
1. **–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ —Ç–µ—Å—Ç–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Æ–ö–∞—Å—Å–∞** —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
   - Shop ID: `1116141` 
   - –¢–µ—Å—Ç–æ–≤—ã–π –∫–ª—é—á: `test_*grCMbJSK95l5oz0pzlWrl1YeUJsDJusxy9MbxB_0AP0Y`
   - API URL: `https://api.yookassa.ru/v3`

2. **–ü—Ä–æ–≤–µ–¥–µ–Ω–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - ‚úÖ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
   - ‚úÖ –Æ–ö–∞—Å—Å–∞ WebClient –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω 
   - ‚úÖ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è admin –∏ –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - ‚úÖ –°–ë–ü –±–∞–Ω–∫–∏ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 8 –±–∞–Ω–∫–æ–≤ (–°–±–µ—Ä–±–∞–Ω–∫, –¢–∏–Ω—å–∫–æ—Ñ—Ñ, –í–¢–ë, –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫ –∏ –¥—Ä.)
   - ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ API
   - ‚úÖ –ú–æ–±–∏–ª—å–Ω—ã–π API `/api/v1/mobile/payments/create` —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

3. **–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã**:
   - –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞: `5555555555554444` (CVV: 123, —Å—Ä–æ–∫: 12/30)
   - –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞: `4111111111111112` (CVV: 123, —Å—Ä–æ–∫: 12/30)
   - 3DS –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: `4000000000000002` (CVV: 123, —Å—Ä–æ–∫: 12/30)
   - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤: `4000000000000051` (CVV: 123, —Å—Ä–æ–∫: 12/30)

### üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ö–æ—Ä–∑–∏–Ω–∞**: –æ—à–∏–±–∫–∞ 500 –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
2. **Health endpoints**: —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω –≤–º–µ—Å—Ç–æ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
3. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤**: —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ç—Ä–µ–±—É–µ—Ç —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ

### üöÄ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –®–∞–≥ 2 - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞ –∏ –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Ü–∏–∫–ª–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –∫–æ—Ä–∑–∏–Ω—ã** –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
2. **–°–æ–∑–¥–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑** –≤ —Å–∏—Å—Ç–µ–º–µ
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –ø–ª–∞—Ç–µ–∂–µ–π** —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏ –Æ–ö–∞—Å—Å–∞
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å webhook** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
5. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å health endpoints** –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—é:** ‚úÖ 95% - –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Æ–ö–∞—Å—Å–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –æ—Å—Ç–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –º–µ–ª–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

–•–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å **–®–∞–≥–∞ 2** –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –∫–æ—Ä–∑–∏–Ω—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞?

---

_**User**_

–¥–∞–≤–∞–π –ø–µ—Ä—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É 2. –ù–æ –ø–µ—Ä–µ–¥ —ç—Ç–∏ –∏–∑—É—á–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é  –ö–ª—é—á API
test_A_jprj_408ySIz9HzYvC5WzxuB-mwKGqrp-7MfI_2B0
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è @https://yookassa.ru/developers/using-api/interaction-format#auth
 
–ö–ª—é—á –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ SDK
test_MTExNjE0MTdtMbsnxRGOphBSgVFAOYjWsNpAYjFN9Zg
–î–æ—É–º–µ–Ω—Ç–∞—Ü–∏—è @https://yookassa.ru/developers/payment-acceptance/integration-scenarios/mobile-sdks/android-sdk
 

SHOP_ID 
1116141
–î–æ–∫—É–º–µ–Ω—Ç–∫–∞—Ü–∏—è@ https://yookassa.ru/docs/support/merchant/payouts/secret-key 


–¢–µ—Å—Ç–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏ 
@https://yookassa.ru/docs/support/merchant/payments/implement/test-store 

–î–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤ 
@https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing#test-bank-card-data      –≤—Å–µ —ç–Ω–¥–ø–æ–π—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É @http://api.pizzanat.ru/ 


---

_**Assistant**_

–û—Ç–ª–∏—á–Ω–æ! –ò–∑—É—á–∏–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –Æ–ö–∞—Å—Å–∞ –∏ –≤–∏–∂—É, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏. –î–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–π–¥–µ–º –∫ **–®–∞–≥—É 2** —Å –Ω–æ–≤—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

## üîç –ê–Ω–∞–ª–∏–∑ –Ω–æ–≤—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Æ–ö–∞—Å—Å–∞

–°–æ–≥–ª–∞—Å–Ω–æ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Æ–ö–∞—Å—Å–∞ –ø–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏](https://yookassa.ru/developers/using-api/interaction-format#auth), —É –Ω–∞—Å –µ—Å—Ç—å:

**–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏:**
- **API –∫–ª—é—á**: `test_A_jprj_408ySIz9HzYvC5WzxuB-mwKGqrp-7MfI_2B0` (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- **–ú–æ–±–∏–ª—å–Ω—ã–π SDK –∫–ª—é—á**: `test_MTExNjE0MTdtMbsnxRGOphBSgVFAOYjWsNpAYjFN9Zg` (–¥–ª—è [Android SDK](https://yookassa.ru/developers/payment-acceptance/integration-scenarios/mobile-sdks/android-sdk))
- **Shop ID**: `1116141` (–æ—Å—Ç–∞–ª—Å—è —Ç–æ—Ç –∂–µ)

**–¢–µ—Å—Ç–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**
- [–¢–µ—Å—Ç–æ–≤—ã–π –º–∞–≥–∞–∑–∏–Ω](https://yookassa.ru/docs/support/merchant/payments/implement/test-store)
- [–¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã](https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing#test-bank-card-data)
- API –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://api.pizzanat.ru/`

–î–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –æ–±–Ω–æ–≤–∏–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å –Ω–æ–≤—ã–º–∏ –∫–ª—é—á–∞–º–∏, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–π–¥–µ–º –∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –∫–æ—Ä–∑–∏–Ω—ã –∏ —Å–æ–∑–¥–∞–Ω–∏—é —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞.

---

```diff
  # PizzaNat - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –≠—Ç–∞–ø–∞ 6 (–§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- # –†–µ–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ÆKassa
+ # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ÆKassa
  
  # –ÆKassa —Ç–µ—Å—Ç–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è PizzaNat - Stage 6
- # –†–µ–∞–ª—å–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
+ # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  
  # === –û–°–ù–û–í–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò YOOKASSA ===
  YOOKASSA_ENABLED=true
  YOOKASSA_SHOP_ID=1116141
- YOOKASSA_SECRET_KEY=test_grCMbJSK95l5oz0pzlWrl1YeUJsDJusxy9MbxB_0AP0Y
+ YOOKASSA_SECRET_KEY=test_A_jprj_408ySIz9HzYvC5WzxuB-mwKGqrp-7MfI_2B0
+ 
+ # === –ú–û–ë–ò–õ–¨–ù–´–ô SDK –ö–õ–Æ–ß ===
+ YOOKASSA_MOBILE_SDK_KEY=test_MTExNjE0MTdtMbsnxRGOphBSgVFAOYjWsNpAYjFN9Zg
  
  # === API –ù–ê–°–¢–†–û–ô–ö–ò ===
  YOOKASSA_API_URL=https://api.yookassa.ru/v3
- YOOKASSA_WEBHOOK_URL=https://debaganov-pizzanat-0177.twc1.net/api/v1/payments/yookassa/webhook
+ YOOKASSA_WEBHOOK_URL=http://api.pizzanat.ru/api/v1/payments/yookassa/webhook
  YOOKASSA_RETURN_URL=pizzanat://payment/result
  
```

```diff
  
  # === –¢–ï–°–¢–û–í–´–ï –ö–ê–†–¢–´ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò ===
+ # –°–æ–≥–ª–∞—Å–Ω–æ https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing#test-bank-card-data
  # –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 5555555555554444, CVV: 123, —Å—Ä–æ–∫: 12/30
  # –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 4111111111111112, CVV: 123, —Å—Ä–æ–∫: 12/30
```

```diff
  # –¢–µ—Å—Ç–æ–≤—ã–π –º–∞–≥–∞–∑–∏–Ω: https://yookassa.ru/docs/support/merchant/payments/implement/test-store
  # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç: https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing#test-bank-card-data
- # –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á: https://yookassa.ru/docs/support/merchant/payouts/secret-key
+ # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è API: https://yookassa.ru/developers/using-api/interaction-format#auth
+ # Android SDK: https://yookassa.ru/developers/payment-acceptance/integration-scenarios/mobile-sdks/android-sdk
+ # –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏: https://yookassa.ru/docs/support/merchant/payouts/secret-key
+ 
+ # === –û–ë–ù–û–í–õ–ï–ù–ò–Ø –í STAGE 6 ===
+ # - –û–±–Ω–æ–≤–ª–µ–Ω API –∫–ª—é—á –Ω–∞ test_A_jprj_408ySIz9HzYvC5WzxuB-mwKGqrp-7MfI_2B0
+ # - –î–æ–±–∞–≤–ª–µ–Ω –º–æ–±–∏–ª—å–Ω—ã–π SDK –∫–ª—é—á test_MTExNjE0MTdtMbsnxRGOphBSgVFAOYjWsNpAYjFN9Zg
+ # - –û–±–Ω–æ–≤–ª–µ–Ω webhook URL –Ω–∞ http://api.pizzanat.ru/api/v1/payments/yookassa/webhook
+ # - –î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ÆKassa
  
  # === –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –ü–†–ò–ú–ï–ù–ï–ù–ò–Æ ===
```

---

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø—Ä–∏–º–µ–Ω–∏–º –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ø–µ—Ä–µ–π–¥–µ–º –∫ **–®–∞–≥—É 2**:

---

```bash
./scripts/setup_yookassa_test_mode.sh
```

```
üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞ –ÆKassa...
[2025-06-29 13:03:07] –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ÆKassa...
[2025-06-29 13:03:07] –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
[+] Stopping 1/1
 ‚úî Container pizzanat-app  Stopped                                                                    10.2s 
[2025-06-29 13:03:18] –ó–∞–ø—É—Å–∫ —Å —Ç–µ—Å—Ç–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ÆKassa...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yookassa-test.yml: the attribute `version` is obsolete
, it will be ignored, please remove it to avoid potential confusion
[+] Running 1/1
 ‚úî Container pizzanat-app  Started                                                                     0.2s 
[2025-06-29 13:03:18] –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä app –∑–∞–ø—É—â–µ–Ω
[2025-06-29 13:03:28] –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ÆKassa...
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
‚úÖ –û—à–∏–±–æ–∫ –ÆKassa –≤ –ª–æ–≥–∞—Ö –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
‚úÖ –ÆKassa WebClient —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

üìã –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
  üí≥ –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 5555555555554444
  üí≥ –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞: 4111111111111112
  üí≥ 3DS –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: 4000000000000002
  üí≥ –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤: 4000000000000051
  üìÖ –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: 12/30
  üîí CVV: 123

üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:
  üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: https://yookassa.ru/docs/support/merchant/payments/implement/test-store
  üí≥ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç: https://yookassa.ru/developers/payment-acceptance/testing-and-going-live/testing#
test-bank-card-data
  üîë –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏: https://yookassa.ru/docs/support/merchant/payouts/secret-key

üöÄ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
  üì± –ú–æ–±–∏–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏: POST http://localhost:8080/api/v1/mobile/payments/create
  üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π: GET http://localhost:8080/api/v1/payments/metrics
  üîî Webhook: POST https://debaganov-pizzanat-0177.twc1.net/api/v1/payments/yookassa/webhook
‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –ÆKassa –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!
[2025-06-29 13:03:34] –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: docker compose logs -f app

```

---

–û—Ç–ª–∏—á–Ω–æ! –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –Ω–æ–≤—ã–µ –∫–ª—é—á–∏ –Æ–ö–∞—Å—Å–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –∏ –ø–µ—Ä–µ–π–¥–µ–º –∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã –∫–æ—Ä–∑–∏–Ω—ã:

---

```bash
curl -s "http://localhost:8080/api/v1/payments/yookassa/sbp/banks" | jq .
```

```
a123@MacBookAir PizzaNat % 

```

---

–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –æ–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å:

---

```bash
docker compose logs --tail=20 app
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  | 2025-06-29 13:04:04.655 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSes
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  | 2025-06-29 13:04:05.234 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)

```

---

–í–∏–∂—É –æ—à–∏–±–∫–∏ Telegram –±–æ—Ç–æ–≤ (–∫–æ–Ω—Ñ–ª–∏–∫—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤), –Ω–æ —ç—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –Æ–ö–∞—Å—Å–∞. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º health endpoint –∏ –Æ–ö–∞—Å—Å–∞ API:

---

```bash
curl -s "http://localhost:8080/actuator/health" | jq .
```

```
a123@MacBookAir PizzaNat % curl -s "http://localhost:8080/actuator/health" | jq .
{
  "status": "UP",
  "components": {
    "db": {
      "status": "UP"
    },
    "diskSpace": {
      "status": "UP"
    },
    "healthController": {
      "status": "UP"
    },
    "ping": {
      "status": "UP"
    },
    "ssl": {
      "status": "UP"
    }
  }
}
a123@MacBookAir PizzaNat %
```

---

```bash
sleep 5 && curl -s "http://localhost:8080/api/v1/payments/yookassa/sbp/banks" | jq .
```

```
a123@MacBookAir PizzaNat % 

```

---

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –°–ë–ü API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –Æ–ö–∞—Å—Å–∞ –∏ –∏—Å—Å–ª–µ–¥—É–µ–º –ø—Ä–æ–±–ª–µ–º—É —Å –∫–æ—Ä–∑–∏–Ω–æ–π, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ –≤—ã—è–≤–ª–µ–Ω–∞ –Ω–∞ –®–∞–≥–µ 1:

---

```bash
docker compose logs app | grep -i yookassa | tail -10
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  | 2025-06-29 13:03:28.339 [main] INFO  c.b.pizzanat.config.YooKassaConfig - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ÆKas
sa WebClient. API URL: https://api.yookassa.ru/v3, Shop ID: 1116141
pizzanat-app  | 2025-06-29 13:04:31.145 [scheduling-1] WARN  i.m.core.instrument.MeterRegistry - This Gauge 
has been already registered (MeterId{name='yookassa.payments.last.hour.total', tags=[tag(application=PizzaNa
t),tag(environment=development)]}), the registration will be ignored. Note that subsequent logs will be logg
ed at debug level.

```

---

<details>
            <summary>Searched codebase "CartController addToCart error 500" ‚Ä¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/main/java/com/baganov/pizzanat/service/CartService.java` | L21-75 |
| `src/main/java/com/baganov/pizzanat/controller/CartController.java` | L21-70 |
| `src/main/java/com/baganov/pizzanat/controller/CartController.java` | L1-21 |
| `src/main/java/com/baganov/pizzanat/entity/Cart.java` | L1-77 |
| `src/main/java/com/baganov/pizzanat/service/CartService.java` | L160-204 |
| `src/main/java/com/baganov/pizzanat/repository/CartRepository.java` | L1-17 |
| `src/main/java/com/baganov/pizzanat/controller/CartController.java` | L70-112 |
| `src/main/java/com/baganov/pizzanat/service/CartService.java` | L115-160 |
| `src/main/java/com/baganov/pizzanat/controller/CartController.java` | L192-198 |
| `src/main/java/com/baganov/pizzanat/service/CartService.java` | L1-21 |
| `src/main/java/com/baganov/pizzanat/service/CartService.java` | L75-115 |
| `src/main/java/com/baganov/pizzanat/service/CartService.java` | L204-238 |
| `src/test/java/com/baganov/pizzanat/integration/CartControllerTest.java` | L1-28 |
| `src/main/java/com/baganov/pizzanat/model/dto/cart/CartDTO.java` | L1-22 |
| `src/main/java/com/baganov/pizzanat/controller/CartController.java` | L133-153 |
| `src/main/java/com/baganov/pizzanat/controller/CartController.java` | L112-133 |
| `src/main/java/com/baganov/pizzanat/controller/CartController.java` | L153-192 |
| `src/main/java/com/baganov/pizzanat/entity/CartItem.java` | L1-64 |
| `src/test/java/com/baganov/pizzanat/integration/CartControllerTest.java` | L85-103 |
| `src/main/java/com/baganov/pizzanat/model/dto/cart/AddToCartRequest.java` | L1-37 |
| `src/main/java/com/baganov/pizzanat/model/dto/cart/CartItemDTO.java` | L1-23 |
| `src/test/java/com/baganov/pizzanat/integration/CartControllerTest.java` | L28-61 |
| `src/test/java/com/baganov/pizzanat/integration/CartControllerTest.java` | L127-150 |
| `src/test/java/com/baganov/pizzanat/integration/CartControllerTest.java` | L103-127 |
| `src/main/java/com/baganov/pizzanat/service/OrderService.java` | L48-84 |

</details>

---

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —è –≤–∏–∂—É –∫–æ–¥ –∫–æ—Ä–∑–∏–Ω—ã. –Æ–ö–∞—Å—Å–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –°–ë–ü endpoint —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –î–∞–≤–∞–π—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –∫–æ—Ä–∑–∏–Ω—É –∏ —Å–æ–∑–¥–∞–¥–∏–º –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∑–∞–∫–∞–∑–∞:

---

```bash
curl -s -X POST "http://localhost:8080/api/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }' | jq -r '.token'
```

```
a123@MacBookAir PizzaNat % curl -s -X POST "http://localhost:8080/api/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }' | jq -r '.token'n123"ation/json" \OST "http://localhost:8080/api/v1/auth/login" \
eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE5MTQ4OCwiZXhwIjoxNzUxMjc3ODg4LCJpc3MiOiJQaXp6YU5hdCJ
9.1s3yFPF-GogHXlpJLv0C1cdhedpKh_5CqUxJgan1ywg
a123@MacBookAir PizzaNat %
```

---

–¢–µ–ø–µ—Ä—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –°–ë–ü API –∏ –∫–æ—Ä–∑–∏–Ω—É —Å —Ç–æ–∫–µ–Ω–æ–º:

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE5MTQ4OCwiZXhwIjoxNzUxMjc3ODg4LCJpc3MiOiJQaXp6YU5hdCJ9.1s3yFPF-GogHXlpJLv0C1cdhedpKh_5CqUxJgan1ywg"

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –°–ë–ü API
curl -s -H "Authorization: Bearer $TOKEN" "http://localhost:8080/api/v1/payments/yookassa/sbp/banks" | jq .
```

```
a123@MacBookAir PizzaNat % TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE5MTQ4OCwiZXhwIjoxN
zUxMjc3ODg4LCJpc3MiOiJQaXp6YU5hdCJ9.1s3yFPF-GogHXlpJLv0C1cdhedpKh_5CqUxJgan1ywg"

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –°–ë–ü API
curl -s -H "Authorization: TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE5MTQ4OCwiZXhwIjoxN
curl -s -H "Authorization: Bearer $TOKEN" "http://localhost:8080/api/v1/payments/yookassa/sbp/banks" | jq .
zsh: command not found: #
[
  {
    "bankId": "sberbank",
    "name": "–°–±–µ—Ä–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/sber.svg",
    "available": true
  },
  {
    "bankId": "tinkoff",
    "name": "–¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/tcs.svg",
    "available": true
  },
  {
    "bankId": "vtb",
    "name": "–í–¢–ë",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/vtb.svg",
    "available": true
  },
  {
    "bankId": "alfabank",
    "name": "–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/alfabank.svg",
    "available": true
  },
  {
    "bankId": "raiffeisen",
    "name": "–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/raiffeisen.svg",
    "available": true
  },
  {
    "bankId": "gazprombank",
    "name": "–ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/gazprom.svg",
    "available": true
  },
  {
    "bankId": "rosbank",
    "name": "–†–æ—Å–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/rosbank.svg",
    "available": true
  },
  {
    "bankId": "mkb",
    "name": "–ú–ö–ë",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/mkb.svg",
    "available": true
  }
]
a123@MacBookAir PizzaNat %
```

---

```bash
# –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã
curl -s "http://localhost:8080/api/v1/products" | jq '.[0] | {id, name, price}'
```

```
a123@MacBookAir PizzaNat % # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã
curl -s "http://localhost:8080/api/v1/products" | jq '.[0] | {id, name, price}'
zsh: command not found: #
jq: error (at <stdin>:0): Cannot index object with number
a123@MacBookAir PizzaNat %
```

---

–û—Ç–ª–∏—á–Ω–æ! –°–ë–ü API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 8 –±–∞–Ω–∫–æ–≤. –¢–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∏–º –ø—Ä–æ–¥—É–∫—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã:

---

```bash
curl -s "http://localhost:8080/api/v1/products" | jq '.[0:2] | .[] | {id, name, price}'
```

```
a123@MacBookAir PizzaNat % curl -s "http://localhost:8080/api/v1/products" | jq '.[0:2] | .[] | {id, name, p
rice}'                     curl -s "http://localhost:8080/api/v1/products" | jq '.[0:2] | .[] | {id, name, p
rice}'
jq: error (at <stdin>:0): Cannot index object with object
a123@MacBookAir PizzaNat %
```

---

–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞ API –ø—Ä–æ–¥—É–∫—Ç–æ–≤:

---

```bash
curl -s "http://localhost:8080/api/v1/products" | jq .
```

```
a123@MacBookAir PizzaNat % curl -s "http://localhost:8080/api/v1/products" | jq .
{
  "content": [
    {
      "id": 1,
      "name": "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
      "description": "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∏—Ç–∞–ª—å—è–Ω—Å–∫–∞—è –ø–∏—Ü—Ü–∞ —Å —Ç–æ–º–∞—Ç–Ω—ã–º —Å–æ—É—Å–æ–º –∏ —Å—ã—Ä–æ–º",
      "price": 499.00,
      "discountedPrice": null,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_margarita.png",
      "weight": 450,
      "discountPercent": null,
      "available": true,
      "specialOffer": false
    },
    {
      "id": 3,
      "name": "–ì–∞–≤–∞–π—Å–∫–∞—è –ø–∏—Ü—Ü–∞",
      "description": "–ü–∏—Ü—Ü–∞ —Å –≤–µ—Ç—á–∏–Ω–æ–π –∏ –∞–Ω–∞–Ω–∞—Å–∞–º–∏",
      "price": 549.00,
      "discountedPrice": null,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_gavaiyaskay.png",
      "weight": 470,
      "discountPercent": null,
      "available": true,
      "specialOffer": false
    },
    {
      "id": 4,
      "name": "–°—ã—Ä–Ω–∞—è –ø–∏—Ü—Ü–∞",
      "description": "–ü–∏—Ü—Ü–∞ —Å —á–µ—Ç—ã—Ä—å–º—è –≤–∏–¥–∞–º–∏ —Å—ã—Ä–∞",
      "price": 579.00,
      "discountedPrice": null,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_4_chees.png",
      "weight": 460,
      "discountPercent": null,
      "available": true,
      "specialOffer": false
    },
    {
      "id": 6,
      "name": "–ú—è—Å–Ω–∞—è –ø–∏—Ü—Ü–∞",
      "description": "–ü–∏—Ü—Ü–∞ —Å –∞—Å—Å–æ—Ä—Ç–∏ –∏–∑ –º—è—Å–Ω—ã—Ö –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤",
      "price": 649.00,
      "discountedPrice": null,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_mzysnay.png",
      "weight": 520,
      "discountPercent": null,
      "available": true,
      "specialOffer": false
    },
    {
      "id": 8,
      "name": "–ü–∏—Ü—Ü–∞ –ö–∞—Ä–±–æ–Ω–∞—Ä–∞",
      "description": "–ü–∏—Ü—Ü–∞ –≤ —Å—Ç–∏–ª–µ –ø–∞—Å—Ç—ã –∫–∞—Ä–±–æ–Ω–∞—Ä–∞",
      "price": 629.00,
      "discountedPrice": null,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_karbonara.png",
      "weight": 490,
      "discountPercent": null,
      "available": true,
      "specialOffer": false
    },
    {
      "id": 9,
      "name": "–ì—Ä–∏–±–Ω–∞—è –ø–∏—Ü—Ü–∞",
      "description": "–ü–∏—Ü—Ü–∞ —Å —à–∞–º–ø–∏–Ω—å–æ–Ω–∞–º–∏ –∏ –ª–µ—Å–Ω—ã–º–∏ –≥—Ä–∏–±–∞–º–∏",
      "price": 559.00,
      "discountedPrice": null,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_gribnaya.png",
      "weight": 470,
      "discountPercent": null,
      "available": true,
      "specialOffer": false
    },
    {
      "id": 2,
      "name": "–ü–∏—Ü—Ü–∞ –ü–µ–ø–ø–µ—Ä–æ–Ω–∏",
      "description": "–û—Å—Ç—Ä–∞—è –ø–∏—Ü—Ü–∞ —Å –ø–µ–ø–ø–µ—Ä–æ–Ω–∏ –∏ —Å—ã—Ä–æ–º",
      "price": 599.00,
      "discountedPrice": 509.15,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_peperoni.png",
      "weight": 480,
      "discountPercent": 15,
      "available": true,
      "specialOffer": true
    },
    {
      "id": 5,
      "name": "–ü–∏—Ü—Ü–∞ 5 —Å—ã—Ä–æ–≤",
      "description": "–ü–∏—Ü—Ü–∞ —Å –ø—è—Ç—å—é —Å–æ—Ä—Ç–∞–º–∏ —Å—ã—Ä–∞",
      "price": 649.00,
      "discountedPrice": 584.10,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_5_chees.png",
      "weight": 490,
      "discountPercent": 10,
      "available": true,
      "specialOffer": true
    },
    {
      "id": 7,
      "name": "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–∏–æ",
      "description": "–§–∏—Ä–º–µ–Ω–Ω–∞—è –ø–∏—Ü—Ü–∞ —Å –±–µ–∫–æ–Ω–æ–º –∏ –≥—Ä–∏–±–∞–º–∏",
      "price": 599.00,
      "discountedPrice": 509.15,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_mario.png",
      "weight": 500,
      "discountPercent": 15,
      "available": true,
      "specialOffer": true
    },
    {
      "id": 10,
      "name": "–ü–∏—Ü—Ü–∞ –¢–æ–º –Ø–º",
      "description": "–û—Å—Ç—Ä–∞—è –ø–∏—Ü—Ü–∞ –≤ —Å—Ç–∏–ª–µ —Ç–∞–π—Å–∫–æ–≥–æ —Å—É–ø–∞",
      "price": 679.00,
      "discountedPrice": 597.52,
      "categoryId": 1,
      "categoryName": "–ü–∏—Ü—Ü—ã",
      "imageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_tom_yam.png",
      "weight": 490,
      "discountPercent": 12,
      "available": true,
      "specialOffer": true
    }
  ],
  "pageable": {
    "pageNumber": 0,
    "pageSize": 10,
    "sort": {
      "empty": true,
      "sorted": false,
      "unsorted": true
    },
    "offset": 0,
    "paged": true,
    "unpaged": false
  },
  "totalElements": 32,
  "totalPages": 4,
  "last": false,
  "size": 10,
  "number": 0,
  "sort": {
    "empty": true,
    "sorted": false,
    "unsorted": true
  },
  "numberOfElements": 10,
  "first": true,
  "empty": false
}
a123@MacBookAir PizzaNat %
```

---

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –∫–æ—Ä–∑–∏–Ω—É —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º–∏. –ù–∞—á–Ω–µ–º —Å **–®–∞–≥–∞ 2** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã –∏ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞:

---

```bash
# –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∏—Ü—Ü—ã –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞ (ID=1) –≤ –∫–æ—Ä–∑–∏–Ω—É
curl -s -X POST "http://localhost:8080/api/v1/cart/items" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "productId": 1,
    "quantity": 2
  }' | jq .
```

```
a123@MacBookAir PizzaNat % # –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∏—Ü—Ü—ã –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞ (ID=1) –≤ –∫–æ—Ä–∑–∏–Ω—É
curl -s -X POST "http://localhost:8080/api/v1/cart/items" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "productId": 1,
    "quantity": 2
  }' | jq .ty": 21,: Bearer $TOKEN" \ \api/v1/cart/items" \–≥–∞—Ä–∏—Ç–∞ (ID=1) –≤ –∫–æ—Ä–∑–∏–Ω—É
zsh: unknown file attribute: 1
{
  "id": 1,
  "sessionId": null,
  "totalAmount": 998.00,
  "items": [
    {
      "id": 1,
      "productId": 1,
      "productName": "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
      "productImageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_margarita.png",
      "price": 499.00,
      "discountedPrice": 499.00,
      "quantity": 2,
      "subtotal": 998.00
    }
  ]
}
a123@MacBookAir PizzaNat %
```

---

üéâ **–û—Ç–ª–∏—á–Ω–æ! –ö–æ—Ä–∑–∏–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!** –¢–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–∏–º –µ—â–µ –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä –∏ —Å–æ–∑–¥–∞–¥–∏–º –∑–∞–∫–∞–∑:

---

```bash
# –î–æ–±–∞–≤–ª—è–µ–º –ø–∏—Ü—Ü—É –ü–µ–ø–ø–µ—Ä–æ–Ω–∏ (ID=2) –≤ –∫–æ—Ä–∑–∏–Ω—É
curl -s -X POST "http://localhost:8080/api/v1/cart/items" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "productId": 2,
    "quantity": 1
  }' | jq .
```

```
zsh: unknown file attribute: 2
{
  "id": 1,
  "sessionId": null,
  "totalAmount": 1507.15,
  "items": [
    {
      "id": 1,
      "productId": 1,
      "productName": "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
      "productImageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_margarita.png",
      "price": 499.00,
      "discountedPrice": 499.00,
      "quantity": 2,
      "subtotal": 998.00
    },
    {
      "id": 2,
      "productId": 2,
      "productName": "–ü–∏—Ü—Ü–∞ –ü–µ–ø–ø–µ—Ä–æ–Ω–∏",
      "productImageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_peperoni.png",
      "price": 599.00,
      "discountedPrice": 509.15,
      "quantity": 1,
      "subtotal": 509.15
    }
  ]
}

```

---

–û—Ç–ª–∏—á–Ω–æ! –ö–æ—Ä–∑–∏–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ. –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –∑–∞–∫–∞–∑. –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫–∏–µ –ø—É–Ω–∫—Ç—ã –¥–æ—Å—Ç–∞–≤–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã:

---

```bash
# –ü–æ–ª—É—á–∞–µ–º –ø—É–Ω–∫—Ç—ã –¥–æ—Å—Ç–∞–≤–∫–∏
curl -s "http://localhost:8080/api/v1/delivery/locations" | jq '.[:2]'
```

```
zsh: command not found: #
[
  {
    "id": 1,
    "name": "–ü—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏ #1",
    "address": "—É–ª. –õ–µ–Ω–∏–Ω–∞, 10",
    "latitude": 55.75580000,
    "longitude": 37.61730000,
    "workingHours": null,
    "phone": null,
    "active": true
  },
  {
    "id": 2,
    "name": "–ü—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏ #2",
    "address": "—É–ª. –ü—É—à–∫–∏–Ω–∞, 15",
    "latitude": 55.75390000,
    "longitude": 37.62080000,
    "workingHours": null,
    "phone": null,
    "active": true
  }
]

```

---

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –∑–∞–∫–∞–∑:

---

```bash
# –°–æ–∑–¥–∞–µ–º –∑–∞–∫–∞–∑
curl -s -X POST "http://localhost:8080/api/v1/orders" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "deliveryLocationId": 1,
    "contactName": "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "contactPhone": "+79001234567",
    "notes": "–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –Æ–ö–∞—Å—Å–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"
  }' | jq .
```

```
zsh: command not found: #
{
  "id": 1,
  "status": "CREATED",
  "statusDescription": "–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω",
  "deliveryLocationId": 1,
  "deliveryLocationName": "–ü—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏ #1",
  "deliveryLocationAddress": "—É–ª. –õ–µ–Ω–∏–Ω–∞, 10",
  "deliveryAddress": null,
  "totalAmount": 1507.15,
  "comment": "–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –Æ–ö–∞—Å—Å–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏",
  "contactName": "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
  "contactPhone": "+79001234567",
  "createdAt": "2025-06-29T13:05:51.822641922",
  "updatedAt": "2025-06-29T13:05:51.822668797",
  "items": [
    {
      "id": 1,
      "productId": 1,
      "productName": "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
      "productImageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_margarita.png",
      "quantity": 2,
      "price": 499.00,
      "subtotal": 998.00
    },
    {
      "id": 2,
      "productId": 2,
      "productName": "–ü–∏—Ü—Ü–∞ –ü–µ–ø–ø–µ—Ä–æ–Ω–∏",
      "productImageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_peperoni.png",
      "quantity": 1,
      "price": 509.15,
      "subtotal": 509.15
    }
  ]
}

```

---

üéâ **–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!** ID –∑–∞–∫–∞–∑–∞ = 1, —Å—É–º–º–∞ = 1507.15 ‚ÇΩ. –¢–µ–ø–µ—Ä—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –Æ–ö–∞—Å—Å–∞:

---

```bash
# –°–æ–∑–¥–∞–µ–º –ø–ª–∞—Ç–µ–∂ –Æ–ö–∞—Å—Å–∞ –¥–ª—è –∑–∞–∫–∞–∑–∞
curl -s -X POST "http://localhost:8080/api/v1/mobile/payments/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "bank_card",
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 –≤ PizzaNat"
  }' | jq .
```

```
zsh: command not found: #
{
  "status": 400,
  "message": "–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ JSON: Cannot deserialize value of type `com.baganov.pizzanat.entity.PaymentMe
thod` from String \"bank_card\": not one of the values accepted for Enum class: [SBP, ALFABANK, BANK_CARD, Y
OOMONEY, SBERBANK, QIWI, WEBMONEY]",
  "timestamp": 1751191563898
}

```

---

–ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ enum. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º:

---

```bash
# –°–æ–∑–¥–∞–µ–º –ø–ª–∞—Ç–µ–∂ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –º–µ—Ç–æ–¥–æ–º
curl -s -X POST "http://localhost:8080/api/v1/mobile/payments/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "BANK_CARD",
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 –≤ PizzaNat"
  }' | jq .
```

```
zsh: command not found: #
{
  "status": 500,
  "message": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",
  "timestamp": 1751191574373
}

```

---

–û—à–∏–±–∫–∞ 500. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

---

```bash
docker compose logs --tail=10 app | grep -A5 -B5 "ERROR\|Exception"
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  | 2025-06-29 13:06:18.637 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)

```

---

–¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ Telegram. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –±–æ–ª–µ–µ —Å–≤–µ–∂–∏–µ –ª–æ–≥–∏:

---

```bash
docker compose logs --since=30s app | grep -v "Telegram\|telegram"
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  | 2025-06-29 13:06:03.894 [http-nio-0.0.0.0-8080-exec-3] ERROR c.b.p.e.GlobalExceptionHandler 
- JSON PARSING ERROR: URL: uri=/api/v1/mobile/payments/create, Message: JSON parse error: Cannot deserialize
 value of type `com.baganov.pizzanat.entity.PaymentMethod` from String "bank_card": not one of the values ac
cepted for Enum class: [SBP, ALFABANK, BANK_CARD, YOOMONEY, SBERBANK, QIWI, WEBMONEY]
pizzanat-app  | org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Cannot
 deserialize value of type `com.baganov.pizzanat.entity.PaymentMethod` from String "bank_card": not one of t
he values accepted for Enum class: [SBP, ALFABANK, BANK_CARD, YOOMONEY, SBERBANK, QIWI, WEBMONEY]
pizzanat-app  |         at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.read
JavaType(AbstractJackson2HttpMessageConverter.java:409)
pizzanat-app  |         at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.read
(AbstractJackson2HttpMessageConverter.java:357)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.annotation.AbstractMessageConverterMet
hodArgumentResolver.readWithMessageConverters(AbstractMessageConverterMethodArgumentResolver.java:204)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodPr
ocessor.readWithMessageConverters(RequestResponseBodyMethodProcessor.java:176)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.annotation.RequestResponseBodyMethodPr
ocessor.resolveArgument(RequestResponseBodyMethodProcessor.java:150)
pizzanat-app  |         at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.res
olveArgument(HandlerMethodArgumentResolverComposite.java:122)
pizzanat-app  |         at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentVa
lues(InvocableHandlerMethod.java:227)
pizzanat-app  |         at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(In
vocableHandlerMethod.java:181)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMeth
od.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapte
r.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapte
r.handleInternal(RequestMappingHandlerAdapter.java:891)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(Ab
stractHandlerMethodAdapter.java:87)
pizzanat-app  |         at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.ja
va:1089)
pizzanat-app  |         at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.jav
a:979)
pizzanat-app  |         at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.
java:1014)
pizzanat-app  |         at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914
)
pizzanat-app  |         at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
pizzanat-app  |         at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:88
5)
pizzanat-app  |         at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:195)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:110)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(Compos
iteFilter.java:108)
pizzanat-app  |         at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(Filte
rChainProxy.java:231)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservatio
n$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObse
rvation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecur
ed$0(ObservationFilterChainDecorator.java:82)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:128)
pizzanat-app  |         at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(Au
thorizationFilter.java:101)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(Excep
tionTranslationFilter.java:126)
pizzanat-app  |         at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(Excep
tionTranslationFilter.java:120)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.session.SessionManagementFilter.doFilter(Session
ManagementFilter.java:131)
pizzanat-app  |         at org.springframework.security.web.session.SessionManagementFilter.doFilter(Session
ManagementFilter.java:85)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doF
ilter(AnonymousAuthenticationFilter.java:100)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilt
er.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(Re
questCacheAwareFilter.java:63)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at com.baganov.pizzanat.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthent
icationFilter.java:90)
pizzanat-app  |         at jdk.internal.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
pizzanat-app  |         at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMeth
odAccessorImpl.java:43)
pizzanat-app  |         at java.base/java.lang.reflect.Method.invoke(Method.java:568)
pizzanat-app  |         at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.
java:359)
pizzanat-app  |         at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.interce
pt(CglibAopProxy.java:724)
pizzanat-app  |         at com.baganov.pizzanat.security.JwtAuthenticationFilter$$SpringCGLIB$$0.doFilterInt
ernal(<generated>)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(Logo
utFilter.java:107)
pizzanat-app  |         at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(Logo
utFilter.java:93)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderW
riterFilter.java:90)
pizzanat-app  |         at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(Heade
rWriterFilter.java:75)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(Sec
urityContextHolderFilter.java:82)
pizzanat-app  |         at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(Sec
urityContextHolderFilter.java:69)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.context.request.async.WebAsyncManagerIntegration
Filter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(
DisableEncodeUrlFilter.java:42)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObse
rvation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:224)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainPro
xy.java:233)
pizzanat-app  |         at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:
191)
pizzanat-app  |         at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(Compos
iteFilter.java:113)
pizzanat-app  |         at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createC
acheFilter$3(HandlerMappingIntrospector.java:243)
pizzanat-app  |         at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(Compos
iteFilter.java:113)
pizzanat-app  |         at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
pizzanat-app  |         at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityCo
nfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
pizzanat-app  |         at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFil
terProxy.java:362)
pizzanat-app  |         at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterPro
xy.java:278)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestConte
xtFilter.java:100)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilt
er.java:93)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(Serve
rHttpObservationFilter.java:114)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(Character
EncodingFilter.java:201)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:16
7)
pizzanat-app  |         at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90
)
pizzanat-app  |         at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java
:483)
pizzanat-app  |         at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
pizzanat-app  |         at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
pizzanat-app  |         at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
pizzanat-app  |         at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
pizzanat-app  |         at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
pizzanat-app  |         at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
pizzanat-app  |         at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.jav
a:903)
pizzanat-app  |         at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:174
0)
pizzanat-app  |         at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
pizzanat-app  |         at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.ja
va:1189)
pizzanat-app  |         at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.j
ava:658)
pizzanat-app  |         at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63
)
pizzanat-app  |         at java.base/java.lang.Thread.run(Thread.java:833)
pizzanat-app  | Caused by: com.fasterxml.jackson.databind.exc.InvalidFormatException: Cannot deserialize val
ue of type `com.baganov.pizzanat.entity.PaymentMethod` from String "bank_card": not one of the values accept
ed for Enum class: [SBP, ALFABANK, BANK_CARD, YOOMONEY, SBERBANK, QIWI, WEBMONEY]
pizzanat-app  |  at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 3, co
lumn: 15] (through reference chain: com.baganov.pizzanat.model.dto.payment.CreatePaymentRequest["method"])
pizzanat-app  |         at com.fasterxml.jackson.databind.exc.InvalidFormatException.from(InvalidFormatExcep
tion.java:67)
pizzanat-app  |         at com.fasterxml.jackson.databind.DeserializationContext.weirdStringException(Deseri
alizationContext.java:1959)
pizzanat-app  |         at com.fasterxml.jackson.databind.DeserializationContext.handleWeirdStringValue(Dese
rializationContext.java:1245)
pizzanat-app  |         at com.fasterxml.jackson.databind.deser.std.EnumDeserializer._deserializeAltString(E
numDeserializer.java:447)
pizzanat-app  |         at com.fasterxml.jackson.databind.deser.std.EnumDeserializer._fromString(EnumDeseria
lizer.java:304)
pizzanat-app  |         at com.fasterxml.jackson.databind.deser.std.EnumDeserializer.deserialize(EnumDeseria
lizer.java:273)
pizzanat-app  |         at com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeAndSet(Method
Property.java:129)
pizzanat-app  |         at com.fasterxml.jackson.databind.deser.BeanDeserializer.vanillaDeserialize(BeanDese
rializer.java:310)
pizzanat-app  |         at com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserialize
r.java:177)
pizzanat-app  |         at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(
DefaultDeserializationContext.java:342)
pizzanat-app  |         at com.fasterxml.jackson.databind.ObjectReader._bindAndClose(ObjectReader.java:2131)
pizzanat-app  |         at com.fasterxml.jackson.databind.ObjectReader.readValue(ObjectReader.java:1501)
pizzanat-app  |         at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.read
JavaType(AbstractJackson2HttpMessageConverter.java:398)
pizzanat-app  |         ... 144 common frames omitted
pizzanat-app  | 2025-06-29 13:06:03.898 [http-nio-0.0.0.0-8080-exec-3] ERROR c.b.p.e.GlobalExceptionHandler 
- JSON Processing Exception: Cannot deserialize value of type `com.baganov.pizzanat.entity.PaymentMethod` fr
om String "bank_card": not one of the values accepted for Enum class: [SBP, ALFABANK, BANK_CARD, YOOMONEY, S
BERBANK, QIWI, WEBMONEY]
pizzanat-app  | 2025-06-29 13:06:14.370 [http-nio-0.0.0.0-8080-exec-7] ERROR c.b.p.e.GlobalExceptionHandler 
- GENERIC ERROR: URL: uri=/api/v1/mobile/payments/create, Exception: AuthorizationDeniedException, Message:
Access Denied
pizzanat-app  | org.springframework.security.authorization.AuthorizationDeniedException: Access Denied
pizzanat-app  |         at org.springframework.security.authorization.method.ThrowingMethodAuthorizationDeni
edHandler.handleDeniedInvocation(ThrowingMethodAuthorizationDeniedHandler.java:38)
pizzanat-app  |         at org.springframework.security.authorization.method.PreAuthorizeAuthorizationManage
r.handleDeniedInvocation(PreAuthorizeAuthorizationManager.java:108)
pizzanat-app  |         at org.springframework.security.authorization.ObservationAuthorizationManager.handle
DeniedInvocation(ObservationAuthorizationManager.java:117)
pizzanat-app  |         at org.springframework.security.authorization.method.AuthorizationManagerBeforeMetho
dInterceptor.handle(AuthorizationManagerBeforeMethodInterceptor.java:287)
pizzanat-app  |         at org.springframework.security.authorization.method.AuthorizationManagerBeforeMetho
dInterceptor.attemptAuthorization(AuthorizationManagerBeforeMethodInterceptor.java:260)
pizzanat-app  |         at org.springframework.security.authorization.method.AuthorizationManagerBeforeMetho
dInterceptor.invoke(AuthorizationManagerBeforeMethodInterceptor.java:196)
pizzanat-app  |         at org.springframework.security.config.annotation.method.configuration.DeferringMeth
odInterceptor.invoke(DeferringMethodInterceptor.java:44)
pizzanat-app  |         at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMe
thodInvocation.java:184)
pizzanat-app  |         at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.interce
pt(CglibAopProxy.java:728)
pizzanat-app  |         at com.baganov.pizzanat.controller.MobilePaymentController$$SpringCGLIB$$0.createMob
ilePayment(<generated>)
pizzanat-app  |         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
pizzanat-app  |         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccess
orImpl.java:77)
pizzanat-app  |         at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMeth
odAccessorImpl.java:43)
pizzanat-app  |         at java.base/java.lang.reflect.Method.invoke(Method.java:568)
pizzanat-app  |         at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableH
andlerMethod.java:258)
pizzanat-app  |         at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(In
vocableHandlerMethod.java:191)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMeth
od.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapte
r.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapte
r.handleInternal(RequestMappingHandlerAdapter.java:891)
pizzanat-app  |         at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(Ab
stractHandlerMethodAdapter.java:87)
pizzanat-app  |         at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.ja
va:1089)
pizzanat-app  |         at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.jav
a:979)
pizzanat-app  |         at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.
java:1014)
pizzanat-app  |         at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914
)
pizzanat-app  |         at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:590)
pizzanat-app  |         at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:88
5)
pizzanat-app  |         at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:195)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:110)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(Compos
iteFilter.java:108)
pizzanat-app  |         at org.springframework.security.web.FilterChainProxy.lambda$doFilterInternal$3(Filte
rChainProxy.java:231)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$FilterObservatio
n$SimpleFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:479)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObse
rvation$SimpleAroundFilterObservation.lambda$wrap$1(ObservationFilterChainDecorator.java:340)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator.lambda$wrapSecur
ed$0(ObservationFilterChainDecorator.java:82)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:128)
pizzanat-app  |         at org.springframework.security.web.access.intercept.AuthorizationFilter.doFilter(Au
thorizationFilter.java:101)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(Excep
tionTranslationFilter.java:126)
pizzanat-app  |         at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(Excep
tionTranslationFilter.java:120)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.session.SessionManagementFilter.doFilter(Session
ManagementFilter.java:131)
pizzanat-app  |         at org.springframework.security.web.session.SessionManagementFilter.doFilter(Session
ManagementFilter.java:85)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doF
ilter(AnonymousAuthenticationFilter.java:100)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilt
er.doFilter(SecurityContextHolderAwareRequestFilter.java:179)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(Re
questCacheAwareFilter.java:63)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at com.baganov.pizzanat.security.JwtAuthenticationFilter.doFilterInternal(JwtAuthent
icationFilter.java:90)
pizzanat-app  |         at jdk.internal.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
pizzanat-app  |         at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMeth
odAccessorImpl.java:43)
pizzanat-app  |         at java.base/java.lang.reflect.Method.invoke(Method.java:568)
pizzanat-app  |         at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.
java:359)
pizzanat-app  |         at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.interce
pt(CglibAopProxy.java:724)
pizzanat-app  |         at com.baganov.pizzanat.security.JwtAuthenticationFilter$$SpringCGLIB$$0.doFilterInt
ernal(<generated>)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(Logo
utFilter.java:107)
pizzanat-app  |         at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(Logo
utFilter.java:93)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:91)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.header.HeaderWriterFilter.doHeadersAfter(HeaderW
riterFilter.java:90)
pizzanat-app  |         at org.springframework.security.web.header.HeaderWriterFilter.doFilterInternal(Heade
rWriterFilter.java:75)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(Sec
urityContextHolderFilter.java:82)
pizzanat-app  |         at org.springframework.security.web.context.SecurityContextHolderFilter.doFilter(Sec
urityContextHolderFilter.java:69)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.context.request.async.WebAsyncManagerIntegration
Filter.doFilterInternal(WebAsyncManagerIntegrationFilter.java:62)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:227)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.session.DisableEncodeUrlFilter.doFilterInternal(
DisableEncodeUrlFilter.java:42)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.wrapFilter(ObservationFilterChainDecorator.java:240)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$AroundFilterObse
rvation$SimpleAroundFilterObservation.lambda$wrap$0(ObservationFilterChainDecorator.java:323)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$ObservationFilte
r.doFilter(ObservationFilterChainDecorator.java:224)
pizzanat-app  |         at org.springframework.security.web.ObservationFilterChainDecorator$VirtualFilterCha
in.doFilter(ObservationFilterChainDecorator.java:137)
pizzanat-app  |         at org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainPro
xy.java:233)
pizzanat-app  |         at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:
191)
pizzanat-app  |         at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(Compos
iteFilter.java:113)
pizzanat-app  |         at org.springframework.web.servlet.handler.HandlerMappingIntrospector.lambda$createC
acheFilter$3(HandlerMappingIntrospector.java:243)
pizzanat-app  |         at org.springframework.web.filter.CompositeFilter$VirtualFilterChain.doFilter(Compos
iteFilter.java:113)
pizzanat-app  |         at org.springframework.web.filter.CompositeFilter.doFilter(CompositeFilter.java:74)
pizzanat-app  |         at org.springframework.security.config.annotation.web.configuration.WebMvcSecurityCo
nfiguration$CompositeFilterChainProxy.doFilter(WebMvcSecurityConfiguration.java:238)
pizzanat-app  |         at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFil
terProxy.java:362)
pizzanat-app  |         at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterPro
xy.java:278)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestConte
xtFilter.java:100)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilt
er.java:93)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(Serve
rHttpObservationFilter.java:114)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(Character
EncodingFilter.java:201)
pizzanat-app  |         at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter
.java:116)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilte
rChain.java:164)
pizzanat-app  |         at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.j
ava:140)
pizzanat-app  |         at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:16
7)
pizzanat-app  |         at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90
)
pizzanat-app  |         at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java
:483)
pizzanat-app  |         at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
pizzanat-app  |         at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
pizzanat-app  |         at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
pizzanat-app  |         at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
pizzanat-app  |         at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
pizzanat-app  |         at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
pizzanat-app  |         at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.jav
a:903)
pizzanat-app  |         at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:174
0)
pizzanat-app  |         at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
pizzanat-app  |         at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.ja
va:1189)
pizzanat-app  |         at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.j
ava:658)
pizzanat-app  |         at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63
)
pizzanat-app  |         at java.base/java.lang.Thread.run(Thread.java:833)

```

---

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —è –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—ã:

1. **–ü–µ—Ä–≤–∞—è –æ—à–∏–±–∫–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ enum `"bank_card"` –≤–º–µ—Å—Ç–æ `"BANK_CARD"`
2. **–í—Ç–æ—Ä–∞—è –æ—à–∏–±–∫–∞**: `Access Denied` - –ø—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π:

---

Read file: src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java

---

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å `USER`, –∞ –Ω–∞—à admin —Ç–æ–∫–µ–Ω –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ä–æ–ª—å `ADMIN`. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫–∏–µ —Ä–æ–ª–∏ –µ—Å—Ç—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è admin:

---

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è admin
curl -s -H "Authorization: Bearer $TOKEN" "http://localhost:8080/api/v1/auth/profile" | jq .
```

```
zsh: command not found: #
{
  "status": 500,
  "message": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",
  "timestamp": 1751191608779
}

```

---

–ü–æ–ø—Ä–æ–±—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –≤–º–µ—Å—Ç–æ –º–æ–±–∏–ª—å–Ω–æ–≥–æ:

---

```bash
# –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –ø–ª–∞—Ç–µ–∂–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
curl -s -X POST "http://localhost:8080/api/v1/payments/yookassa/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "BANK_CARD",
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 –≤ PizzaNat"
  }' | jq .
```

```
zsh: command not found: #

```

---

–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, –∫–∞–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã:

---

<details>
            <summary>Searched codebase "YooKassaPaymentController endpoints RequestMapping" ‚Ä¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L31-49 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L1-31 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L221-244 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L32-57 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L1-32 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L49-78 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L197-221 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L78-116 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L116-147 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L147-176 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L353-390 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L244-269 |
| `src/main/java/com/baganov/pizzanat/controller/PaymentController.java` | L1-47 |
| `src/main/java/com/baganov/pizzanat/controller/PaymentMetricsController.java` | L26-57 |
| `src/main/java/com/baganov/pizzanat/config/YooKassaConfig.java` | L25-71 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L79-107 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L38-79 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L1-38 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L176-197 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L218-252 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L390-432 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L271-314 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L107-151 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L198-226 |
| `src/main/java/com/baganov/pizzanat/controller/PaymentMetricsController.java` | L1-26 |

</details>

---

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —è –≤–∏–∂—É, —á—Ç–æ –µ—Å—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä `YooKassaPaymentController` –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ —Ä–æ–ª—è–º. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –µ–≥–æ:

---

```bash
# –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Æ–ö–∞—Å—Å–∞
curl -s -X POST "http://localhost:8080/api/v1/payments/yookassa/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "BANK_CARD",
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 –≤ PizzaNat"
  }' | jq .
```

```
zsh: command not found: #

```

---



–û–ø—è—Ç—å –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –Æ–ö–∞—Å—Å–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–µ–Ω. –í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –æ—Ç–∫–ª—é—á–µ–Ω. –ü—Ä–æ–≤–µ—Ä–∏–º —Å–≤–æ–π—Å—Ç–≤–∞:

---

```bash
docker compose logs --tail=5 app | grep -i yookassa
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion

```

---

```bash
curl -s "http://localhost:8080/api/v1/payments/yookassa/health" | jq .
```

```
a123@MacBookAir PizzaNat % 

```

---

–ö–∞–∂–µ—Ç—Å—è, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã –Æ–ö–∞—Å—Å–∞ –Ω–µ –∞–∫—Ç–∏–≤–Ω—ã. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

---

```bash
docker compose logs --tail=20 app | grep -E "(YooKassa|YOOKASSA|yookassa)"
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion

```

---

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø—É—â–µ–Ω–æ —Å –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π:

---

```bash
docker compose ps
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
NAME           IMAGE          COMMAND                  SERVICE   CREATED         STATUS                   PO
RTS
pizzanat-app   pizzanat-app   "sh -c 'echo 'Starti‚Ä¶"   app       4 minutes ago   Up 4 minutes (healthy)   0.
0.0.0:8080->8080/tcp, [::]:8080->8080/tcp

```

---

```bash
docker compose logs app | grep -A5 -B5 "YooKassa\|YOOKASSA\|yookassa" | tail -20
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  |         at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.interce
pt(CglibAopProxy.java:728)
pizzanat-app  |         at com.baganov.pizzanat.service.YooKassaPaymentService$$SpringCGLIB$$0.createPayment
(<generated>)
pizzanat-app  |         at com.baganov.pizzanat.controller.YooKassaPaymentController.createPayment(YooKassaP
aymentController.java:55)
pizzanat-app  |         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
pizzanat-app  |         at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccess
orImpl.java:77)
pizzanat-app  |         at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMeth
odAccessorImpl.java:43)
pizzanat-app  |         at java.base/java.lang.reflect.Method.invoke(Method.java:568)
pizzanat-app  |         at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableH
andlerMethod.java:258)
--
pizzanat-app  |         at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.j
ava:658)
pizzanat-app  |         at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63
)
pizzanat-app  |         at java.base/java.lang.Thread.run(Thread.java:833)
pizzanat-app  | Caused by: org.hibernate.exception.SQLGrammarException: could not execute statement [ERROR: 
column "metadata" is of type jsonb but expression is of type character varying
pizzanat-app  |   Hint: You will need to rewrite or cast the expression.
pizzanat-app  |   Position: 228] [insert into payments (amount,bank_id,confirmation_url,created_at,currency,
error_message,idempotence_key,metadata,method,order_id,paid_at,receipt_url,refund_id,status,updated_at,yooka
ssa_payment_id) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)]
pizzanat-app  |         at org.hibernate.exception.internal.SQLStateConversionDelegate.convert(SQLStateConve
rsionDelegate.java:91)
pizzanat-app  |         at org.hibernate.exception.internal.StandardSQLExceptionConverter.convert(StandardSQ
LExceptionConverter.java:58)
pizzanat-app  |         at org.hibernate.engine.jdbc.spi.SqlExceptionHelper.convert(SqlExceptionHelper.java:
108)
pizzanat-app  |         at org.hibernate.engine.jdbc.internal.ResultSetReturnImpl.executeUpdate(ResultSetRet
urnImpl.java:197)
pizzanat-app  |         at org.hibernate.id.insert.GetGeneratedKeysDelegate.performMutation(GetGeneratedKeys
Delegate.java:116)

```

---

üéØ **–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —è –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É!** 

–Æ–ö–∞—Å—Å–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã **—Ä–∞–±–æ—Ç–∞—é—Ç**, –Ω–æ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö - –ø–æ–ª–µ `metadata` –∏–º–µ–µ—Ç —Ç–∏–ø `jsonb`, –∞ –º—ã –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–ø–∏—Å–∞—Ç—å `character varying`. –≠—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î.

–î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É:

---

<details>
            <summary>Searched codebase "payments table migration metadata jsonb" ‚Ä¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/main/resources/db/migration/V18__create_payments_table.sql` | L1-58 |
| `src/main/resources/db/migration/V18__create_payments_table.sql` | L58-76 |
| `src/main/java/com/baganov/pizzanat/entity/Payment.java` | L72-151 |
| `src/main/java/com/baganov/pizzanat/entity/Payment.java` | L1-72 |
| `docs/Tasktracker.md` | L2304-2324 |
| `src/main/resources/db/migration/V7__remove_total_amount_from_carts.sql` | L1-5 |
| `src/main/java/com/baganov/pizzanat/entity/PaymentMethod.java` | L1-47 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L390-432 |
| `docs/changelog.md` | L341-374 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L252-290 |
| `src/main/java/com/baganov/pizzanat/entity/Payment.java` | L239-316 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L1-67 |
| `src/main/java/com/baganov/pizzanat/repository/PaymentRepository.java` | L56-101 |
| `src/main/java/com/baganov/pizzanat/entity/Payment.java` | L151-239 |
| `src/main/resources/db/migration/V2__create_order_statuses.sql` | L1-49 |
| `docs/changelog.md` | L313-341 |
| `src/main/java/com/baganov/pizzanat/repository/PaymentRepository.java` | L101-122 |
| `src/main/resources/db/migration/V1__init_schema.sql` | L56-112 |
| `src/main/java/com/baganov/pizzanat/model/dto/payment/PaymentResponse.java` | L1-68 |
| `src/main/java/com/baganov/pizzanat/repository/PaymentRepository.java` | L1-56 |
| `src/main/resources/db/migration/V1__init_schema.sql` | L1-56 |
| `src/main/java/com/baganov/pizzanat/controller/PaymentMetricsController.java` | L26-57 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L79-107 |
| `src/main/resources/db/migration/V14__create_scheduled_notifications.sql` | L38-65 |
| `src/main/resources/db/migration/V1__init_schema.sql` | L112-131 |

</details>

---

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –≤ `YooKassaPaymentService.java` –Ω–∞ —Å—Ç—Ä–æ–∫–µ 418 –º—ã –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–ø–∏—Å–∞—Ç—å JSON –∫–∞–∫ —Å—Ç—Ä–æ–∫—É –≤ –ø–æ–ª–µ `metadata`, –Ω–æ –ø–æ–ª–µ –∏–º–µ–µ—Ç —Ç–∏–ø `JSONB`, –∞ –º—ã –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–ø–∏—Å–∞—Ç—å —Å—Ç—Ä–æ–∫—É. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ:

---

Read file: src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java

---

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Å—Ç—Ä–æ–∫–µ 418 - –º—ã –∑–∞–ø–∏—Å—ã–≤–∞–µ–º JSON –∫–∞–∫ —Å—Ç—Ä–æ–∫—É. –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ. –¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª–µ `metadata` –≤ Entity –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å JSONB. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º:

---



---

–¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é –ø–æ–ª—è `metadata` –≤ Entity:

---

Read file: src/main/java/com/baganov/pizzanat/entity/Payment.java

---

–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è. –ü—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Ç–æ–º, —á—Ç–æ Hibernate –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å–∞—Ç—å —Å—Ç—Ä–æ–∫—É –≤ JSONB –ø–æ–ª–µ. –î–∞–≤–∞–π—Ç–µ –¥–æ–±–∞–≤–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞–Ω–Ω–æ—Ç–∞—Ü–∏—é –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å JSONB:

---



---

–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º:

---

```bash
docker compose restart app
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
[+] Restarting 0/1
[+] Restarting 0/1nat-app  Restarting                                                                  0.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.9s 
[+] Restarting 0/1nat-app  Restarting                                                                 10.0s 
[+] Restarting 0/1nat-app  Restarting                                                                 10.1s 
[+] Restarting 0/1nat-app  Restarting                                                                 10.2s 
[+] Restarting 1/1nat-app  Restarting                                                                 10.3s 
 ‚úî Container pizzanat-app  Started                                                                    10.4s 

```

---

–¢–µ–ø–µ—Ä—å –ø–æ–¥–æ–∂–¥–µ–º –∑–∞–ø—É—Å–∫–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –ø–ª–∞—Ç–µ–∂:

---

```bash
sleep 15 && curl -s "http://localhost:8080/actuator/health" | jq .
```

---

_**User**_

	at org.springframework.boot.loader.launch.JarLauncher.main(JarLauncher.java:40)

Caused by: jakarta.persistence.PersistenceException: [PersistenceUnit: default] Unable to build Hibernate SessionFactory; nested exception is org.hibernate.tool.schema.spi.SchemaManagementException: Schema-validation: wrong column type encountered in column [metadata] in table [payments]; found [jsonb (Types#OTHER)], but expecting [text (Types#VARCHAR)]

	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:431)

	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:400)

	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366)

	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1865)

	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1814)

	... 22 common frames omitted

Caused by: org.hibernate.tool.schema.spi.SchemaManagementException: Schema-validation: wrong column type encountered in column [metadata] in table [payments]; found [jsonb (Types#OTHER)], but expecting [text (Types#VARCHAR)]

	at org.hibernate.tool.schema.internal.AbstractSchemaValidator.validateColumnType(AbstractSchemaValidator.java:169)

	at org.hibernate.tool.schema.internal.AbstractSchemaValidator.validateTable(AbstractSchemaValidator.java:156)

	at org.hibernate.tool.schema.internal.GroupedSchemaValidatorImpl.validateTables(GroupedSchemaValidatorImpl.java:46)

	at org.hibernate.tool.schema.internal.AbstractSchemaValidator.performValidation(AbstractSchemaValidator.java:99)

	at org.hibernate.tool.schema.internal.AbstractSchemaValidator.doValidation(AbstractSchemaValidator.java:77)

	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.performDatabaseAction(SchemaManagementToolCoordinator.java:289)

	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.lambda$process$5(SchemaManagementToolCoordinator.java:144)

	at java.base/java.util.HashMap.forEach(HashMap.java:1421)

	at org.hibernate.tool.schema.spi.SchemaManagementToolCoordinator.process(SchemaManagementToolCoordinator.java:141)

	at org.hibernate.boot.internal.SessionFactoryObserverForSchemaExport.sessionFactoryCreated(SessionFactoryObserverForSchemaExport.java:37)

	at org.hibernate.internal.SessionFactoryObserverChain.sessionFactoryCreated(SessionFactoryObserverChain.java:35)

	at org.hibernate.internal.SessionFactoryImpl.<init>(SessionFactoryImpl.java:324)

	at org.hibernate.boot.internal.SessionFactoryBuilderImpl.build(SessionFactoryBuilderImpl.java:463)

	at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1517)

	at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:66)

	at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390)

	at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:419)

	... 26 common frames omitted

Starting PizzaNat applicati

---

_**Assistant**_

–ü–æ–Ω—è—Ç–Ω–æ! –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ `metadata` —É–∂–µ —Å–æ–∑–¥–∞–Ω–æ –∫–∞–∫ `JSONB`, –∞ –º—ã –∏–∑–º–µ–Ω–∏–ª–∏ Entity –Ω–∞ `TEXT`. –ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–∞ –ø–æ–ª—è. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ:

---

```diff
- 
+ -- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø–æ–ª—è metadata –≤ —Ç–∞–±–ª–∏—Ü–µ payments
+ -- V19__fix_payments_metadata_column.sql
+ 
+ -- –ò–∑–º–µ–Ω—è–µ–º —Ç–∏–ø –ø–æ–ª—è metadata —Å JSONB –Ω–∞ TEXT –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Entity
+ ALTER TABLE payments ALTER COLUMN metadata TYPE TEXT;
+ 
+ -- –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
+ COMMENT ON COLUMN payments.metadata IS '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON (—Å—Ç—Ä–æ–∫–∞)'; 
```

---

–¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

---

```bash
docker compose restart app
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
[+] Restarting 0/1
[+] Restarting 0/1nat-app  Restarting                                                                  0.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  0.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  1.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  2.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  3.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  4.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  5.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  6.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  7.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  8.9s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.0s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.1s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.2s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.3s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.4s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.5s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.6s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.7s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.8s 
[+] Restarting 0/1nat-app  Restarting                                                                  9.9s 
[+] Restarting 0/1nat-app  Restarting                                                                 10.0s 
[+] Restarting 0/1nat-app  Restarting                                                                 10.1s 
[+] Restarting 0/1nat-app  Restarting                                                                 10.2s 
[+] Restarting 1/1nat-app  Restarting                                                                 10.3s 
 ‚úî Container pizzanat-app  Started                                                                    10.3s 

```

---

–¢–µ–ø–µ—Ä—å –¥–æ–∂–¥–µ–º—Å—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ:

---

```bash
sleep 15 && curl -s "http://localhost:8080/actuator/health" | jq .
```

```
{
  "status": "UP",
  "components": {
    "db": {
      "status": "UP"
    },
    "diskSpace": {
      "status": "UP"
    },
    "healthController": {
      "status": "UP"
    },
    "ping": {
      "status": "UP"
    },
    "ssl": {
      "status": "UP"
    }
  }
}

```

---

üéâ **–û—Ç–ª–∏—á–Ω–æ! –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å —É—Å–ø–µ—à–Ω–æ!** –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Æ–ö–∞—Å—Å–∞:

---

```bash
docker compose logs --tail=10 app | grep -E "(YooKassa|ERROR|Exception)" | head -5
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  | 2025-06-29 13:24:10.584 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSes
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running

```

---

–¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ Telegram –±–æ—Ç–æ–≤, —á—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ. –¢–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∏–º –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º –Æ–ö–∞—Å—Å–∞:

---

```bash
curl -s -X POST "http://localhost:8080/api/v1/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }' | jq -r '.token'
```

```
eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE5MjY2NiwiZXhwIjoxNzUxMjc5MDY2LCJpc3MiOiJQaXp6YU5hdCJ
9.4Rf1rANzfe_CN3dSLTmFCIbl6Rxn-5WbLJMv8kqdY2w

```

---

–¢–µ–ø–µ—Ä—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –Æ–ö–∞—Å—Å–∞ –¥–ª—è –Ω–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞ #1:

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE5MjY2NiwiZXhwIjoxNzUxMjc5MDY2LCJpc3MiOiJQaXp6YU5hdCJ9.4Rf1rANzfe_CN3dSLTmFCIbl6Rxn-5WbLJMv8kqdY2w"

# –°–æ–∑–¥–∞–µ–º –ø–ª–∞—Ç–µ–∂ –Æ–ö–∞—Å—Å–∞ –¥–ª—è –∑–∞–∫–∞–∑–∞ #1
curl -s -X POST "http://localhost:8080/api/v1/payments/yookassa/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "BANK_CARD",
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 –≤ PizzaNat"
  }' | jq .
```

```
zsh: command not found: #

```

---

–ü–æ–ø—Ä–æ–±—É–µ–º –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è:

---

```bash
TOKEN="eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE5MjY2NiwiZXhwIjoxNzUxMjc5MDY2LCJpc3MiOiJQaXp6YU5hdCJ9.4Rf1rANzfe_CN3dSLTmFCIbl6Rxn-5WbLJMv8kqdY2w"

curl -s -X POST "http://localhost:8080/api/v1/payments/yookassa/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "BANK_CARD", 
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 –≤ PizzaNat"
  }' | jq .
```

```
a123@MacBookAir PizzaNat % 

```

---

–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

---

```bash
docker compose logs --tail=20 app | grep -v "Telegram\|telegram"
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion

```

---

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Æ–ö–∞—Å—Å–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Å—Ç—É–ø–µ–Ω:

---

```bash
curl -s -H "Authorization: Bearer $TOKEN" "http://localhost:8080/api/v1/payments/yookassa/sbp/banks" | jq .
```

```
[
  {
    "bankId": "sberbank",
    "name": "–°–±–µ—Ä–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/sber.svg",
    "available": true
  },
  {
    "bankId": "tinkoff",
    "name": "–¢–∏–Ω—å–∫–æ—Ñ—Ñ –ë–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/tcs.svg",
    "available": true
  },
  {
    "bankId": "vtb",
    "name": "–í–¢–ë",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/vtb.svg",
    "available": true
  },
  {
    "bankId": "alfabank",
    "name": "–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/alfabank.svg",
    "available": true
  },
  {
    "bankId": "raiffeisen",
    "name": "–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/raiffeisen.svg",
    "available": true
  },
  {
    "bankId": "gazprombank",
    "name": "–ì–∞–∑–ø—Ä–æ–º–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/gazprom.svg",
    "available": true
  },
  {
    "bankId": "rosbank",
    "name": "–†–æ—Å–±–∞–Ω–∫",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/rosbank.svg",
    "available": true
  },
  {
    "bankId": "mkb",
    "name": "–ú–ö–ë",
    "shortName": "https://static.yoomoney.ru/files-front/banks-logos/mkb.svg",
    "available": true
  }
]

```

---

–û—Ç–ª–∏—á–Ω–æ! –°–ë–ü API —Ä–∞–±–æ—Ç–∞–µ—Ç. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –¥—Ä—É–≥–æ–π endpoint –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞. –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ endpoint `/create` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:

---

<details>
            <summary>Searched codebase "YooKassaPaymentController create payment endpoint mapping" ‚Ä¢ **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L31-49 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L1-31 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L221-244 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L32-57 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L49-78 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L1-32 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L78-116 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L197-221 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L147-176 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L116-147 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L455-478 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L79-107 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L353-390 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L244-269 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L38-79 |
| `src/main/java/com/baganov/pizzanat/controller/PaymentController.java` | L1-47 |
| `src/main/java/com/baganov/pizzanat/controller/YooKassaPaymentController.java` | L176-197 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L390-430 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L1-38 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L218-252 |
| `src/main/java/com/baganov/pizzanat/controller/PaymentMetricsController.java` | L26-57 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L314-353 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L1-67 |
| `src/main/java/com/baganov/pizzanat/service/YooKassaPaymentService.java` | L271-314 |
| `src/main/java/com/baganov/pizzanat/controller/MobilePaymentController.java` | L198-226 |

</details>

---

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —è –≤–∏–∂—É, —á—Ç–æ endpoint `/create` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ü—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ JSON –æ—Ç–≤–µ—Ç–∞. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ:

---

```bash
docker compose logs --since=2m app | grep -E "(ERROR|Exception|create|payment|POST)" | tail -10
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  | 2025-06-29 13:25:26.064 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  | 2025-06-29 13:25:29.653 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSes
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  | 2025-06-29 13:25:30.234 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  | 2025-06-29 13:25:33.776 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSes
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  | 2025-06-29 13:25:34.411 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running

```

---

–¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ Telegram. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —Å verbose curl –∏ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:

---

```bash
curl -v -X POST "http://localhost:8080/api/v1/payments/yookassa/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "BANK_CARD", 
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 –≤ PizzaNat"
  }'
```

```
Note: Unnecessary use of -X or --request, POST is already inferred.
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
> POST /api/v1/payments/yookassa/create HTTP/1.1
> Host: localhost:8080
> User-Agent: curl/8.7.1
> Accept: */*
> Content-Type: application/json
> Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImlhdCI6MTc1MTE5MjY2NiwiZXhwIjoxNzUxMjc5MDY
2LCJpc3MiOiJQaXp6YU5hdCJ9.4Rf1rANzfe_CN3dSLTmFCIbl6Rxn-5WbLJMv8kqdY2w
> Content-Length: 182
> 
* upload completely sent off: 182 bytes
< HTTP/1.1 400 
< Vary: Origin
< Vary: Access-Control-Request-Method
< Vary: Access-Control-Request-Headers
< X-Content-Type-Options: nosniff
< X-XSS-Protection: 0
< Cache-Control: no-cache, no-store, max-age=0, must-revalidate
< Pragma: no-cache
< Expires: 0
< X-Frame-Options: DENY
< Content-Length: 0
< Date: Sun, 29 Jun 2025 10:25:47 GMT
< Connection: close
< 
* Closing connection

```

---

–ü–æ–ª—É—á–∞–µ–º HTTP 400 (Bad Request). –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ `CreatePaymentRequest` DTO:

---

Read file: src/main/java/com/baganov/pizzanat/model/dto/payment/CreatePaymentRequest.java

---

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º `"method": "BANK_CARD"` –∫–∞–∫ —Å—Ç—Ä–æ–∫—É, –∞ DTO –æ–∂–∏–¥–∞–µ—Ç enum `PaymentMethod`. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ enum:

---

Read file: src/main/java/com/baganov/pizzanat/entity/PaymentMethod.java

---

–¢–µ–ø–µ—Ä—å —è –ø–æ–Ω–∏–º–∞—é! –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ enum –∑–Ω–∞—á–µ–Ω–∏—è - `BANK_CARD`, –Ω–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –∫–∞–∫ enum, –∞ –Ω–µ —Å—Ç—Ä–æ–∫—É. –ü–æ–ø—Ä–æ–±—É–µ–º –µ—â–µ —Ä–∞–∑:

---

```bash
curl -s -X POST "http://localhost:8080/api/v1/payments/yookassa/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "BANK_CARD", 
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 –≤ PizzaNat"
  }' | jq .
```

```
a123@MacBookAir PizzaNat % 

```

---

–ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ–ø—è—Ç—å. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —Å –°–ë–ü –º–µ—Ç–æ–¥–æ–º, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω—ã–º:

---

```bash
curl -s -X POST "http://localhost:8080/api/v1/payments/yookassa/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "SBP", 
    "bankId": "sberbank",
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 —á–µ—Ä–µ–∑ –°–ë–ü"
  }' | jq .
```

```
a123@MacBookAir PizzaNat % 

```

---

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –≤–æ–æ–±—â–µ. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –∏ –∞–∫—Ç–∏–≤–µ–Ω:

---

```bash
curl -s -H "Authorization: Bearer $TOKEN" "http://localhost:8080/api/v1/payments/yookassa/health" | jq .
```

```
{
  "status": "ok",
  "service": "yookassa",
  "timestamp": 1751192797738,
  "message": "–ÆKassa –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç"
}

```

---

Health endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç! –ó–Ω–∞—á–∏—Ç, –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ endpoint `/create` –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

---

```bash
docker compose logs -f --tail=0 app &
sleep 2
curl -s -X POST "http://localhost:8080/api/v1/payments/yookassa/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "SBP", 
    "bankId": "sberbank",
    "amount": 1507.15,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 —á–µ—Ä–µ–∑ –°–ë–ü"
  }'
sleep 3
kill %1
```

```
[1] 19575
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  | 2025-06-29 13:26:48.697 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSes
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  | 2025-06-29 13:26:50.081 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  | 2025-06-29 13:26:50.585 [http-nio-0.0.0.0-8080-exec-7] INFO  c.b.p.c.YooKassaPaymentControll
er - üîÑ –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –ÆKassa: –∑–∞–∫–∞–∑=1, –º–µ—Ç–æ–¥=SBP, –±–∞–Ω–∫=sberbank
pizzanat-app  | 2025-06-29 13:26:50.585 [http-nio-0.0.0.0-8080-exec-7] INFO  c.b.p.service.YooKassaPaymentSe
rvice - üîÑ –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –ÆKassa –¥–ª—è –∑–∞–∫–∞–∑–∞ 1
pizzanat-app  | 2025-06-29 13:26:50.630 [http-nio-0.0.0.0-8080-exec-7] WARN  c.b.p.c.YooKassaPaymentControll
er - ‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞: –ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω: 1
 pizzanat-app  | 2025-06-29 13:26:52.913 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSe
s
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)

```

---

üéØ **–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —è –≤–∏–∂—É –ø—Ä–æ–±–ª–µ–º—É!**

–õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:
```
‚ö†Ô∏è –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞: –ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω: 1
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:
1. ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Æ–ö–∞—Å—Å–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å
2. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è JSON –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ  
3. ‚ùå –ó–∞–∫–∞–∑ #1 –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–∫–∞–∑—ã –∏–∑ –±–∞–∑—ã –ø—Ä–æ–ø–∞–ª–∏. –î–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑:

---

```bash
# –°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤–∏–º —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É
curl -s -X POST "http://localhost:8080/api/v1/cart/items" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "productId": 1,
    "quantity": 2
  }' | jq .
```

```
zsh: command not found: #
{
  "id": 1,
  "sessionId": null,
  "totalAmount": 998.00,
  "items": [
    {
      "id": 1,
      "productId": 1,
      "productName": "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
      "productImageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_margarita.png",
      "price": 499.00,
      "discountedPrice": 499.00,
      "quantity": 2,
      "subtotal": 998.00
    }
  ]
}

```

---

–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –∑–∞–∫–∞–∑:

---

```bash
curl -s -X POST "http://localhost:8080/api/v1/orders" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "deliveryLocationId": 1,
    "contactName": "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "contactPhone": "+79001234567",
    "notes": "–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –Æ–ö–∞—Å—Å–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ - –®–∞–≥ 2"
  }' | jq .
```

```
{
  "id": 1,
  "status": "CREATED",
  "statusDescription": "–ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω",
  "deliveryLocationId": 1,
  "deliveryLocationName": "–ü—É–Ω–∫—Ç –≤—ã–¥–∞—á–∏ #1",
  "deliveryLocationAddress": "—É–ª. –õ–µ–Ω–∏–Ω–∞, 10",
  "deliveryAddress": null,
  "totalAmount": 998.00,
  "comment": "–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–∫–∞–∑ –¥–ª—è –Æ–ö–∞—Å—Å–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ - –®–∞–≥ 2",
  "contactName": "–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
  "contactPhone": "+79001234567",
  "createdAt": "2025-06-29T13:27:19.308591337",
  "updatedAt": "2025-06-29T13:27:19.308609087",
  "items": [
    {
      "id": 1,
      "productId": 1,
      "productName": "–ü–∏—Ü—Ü–∞ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
      "productImageUrl": "https://s3.twcstorage.ru/f9c8e17a-pizzanat-products/products/pizza_margarita.png",
      "quantity": 2,
      "price": 499.00,
      "subtotal": 998.00
    }
  ]
}

```

---

üéâ **–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω!** ID = 1, —Å—É–º–º–∞ = 998.00 ‚ÇΩ. –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –ø–ª–∞—Ç–µ–∂ –Æ–ö–∞—Å—Å–∞:

---

```bash
curl -s -X POST "http://localhost:8080/api/v1/payments/yookassa/create" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "orderId": 1,
    "method": "SBP", 
    "bankId": "sberbank",
    "amount": 998.00,
    "returnUrl": "pizzanat://payment/result",
    "description": "–û–ø–ª–∞—Ç–∞ –∑–∞–∫–∞–∑–∞ #1 —á–µ—Ä–µ–∑ –°–ë–ü –°–±–µ—Ä–±–∞–Ω–∫"
  }' | jq .
```

```
{
  "status": 500,
  "message": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",
  "timestamp": 1751192852043
}

```

---

–û—à–∏–±–∫–∞ 500. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏:

---

```bash
docker compose logs --tail=10 app | grep -A10 -B5 "ERROR\|Exception" | tail -20
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  | 2025-06-29 13:27:40.157 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)

```

---

–¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ Telegram. –î–∞–≤–∞–π—Ç–µ –ø–æ–∏—â–µ–º –±–æ–ª–µ–µ —Å–≤–µ–∂–∏–µ –ª–æ–≥–∏:

---

```bash
docker compose logs --since=1m app | grep -v "Telegram\|telegram" | tail -10
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.impl.UnsupportedTypeSerializer.serialize(Unsup
portedTypeSerializer.java:35)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanProper
tyWriter.java:732)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSer
ializerBase.java:770)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:1
84)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider._serialize(DefaultSe
rializerProvider.java:502)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializeValue(Defau
ltSerializerProvider.java:341)
pizzanat-app  |         at com.fasterxml.jackson.databind.ObjectWriter$Prefetch.serialize(ObjectWriter.java:
1587)
pizzanat-app  |         at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1061)
pizzanat-app  |         at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writ
eInternal(AbstractJackson2HttpMessageConverter.java:486)
pizzanat-app  |         ... 141 common frames omitted

```

---

–í–∏–¥–∏–º –æ—à–∏–±–∫—É —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Jackson. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –ø–æ–ª–Ω—ã–π —Å—Ç–µ–∫ —Ç—Ä–µ–π—Å:

---

```bash
docker compose logs --since=2m app | grep -A20 -B5 "UnsupportedTypeSerializer"
```

```
WARN[0000] /Users/a123/Cursor/PizzaNat/docker-compose.yml: the attribute `version` is obsolete, it will be i
gnored, please remove it to avoid potential confusion
pizzanat-app  |         at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63
)
pizzanat-app  |         at java.base/java.lang.Thread.run(Thread.java:833)
pizzanat-app  | Caused by: com.fasterxml.jackson.databind.exc.InvalidDefinitionException: Java 8 date/time t
ype `java.time.LocalDateTime` not supported by default: add Module "com.fasterxml.jackson.datatype:jackson-d
atatype-jsr310" to enable handling (through reference chain: com.baganov.pizzanat.model.dto.payment.PaymentR
esponse["createdAt"])
pizzanat-app  |         at com.fasterxml.jackson.databind.exc.InvalidDefinitionException.from(InvalidDefinit
ionException.java:77)
pizzanat-app  |         at com.fasterxml.jackson.databind.SerializerProvider.reportBadDefinition(SerializerP
rovider.java:1340)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.impl.UnsupportedTypeSerializer.serialize(Unsup
portedTypeSerializer.java:35)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.BeanPropertyWriter.serializeAsField(BeanProper
tyWriter.java:732)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.std.BeanSerializerBase.serializeFields(BeanSer
ializerBase.java:770)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.BeanSerializer.serialize(BeanSerializer.java:1
84)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider._serialize(DefaultSe
rializerProvider.java:502)
pizzanat-app  |         at com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializeValue(Defau
ltSerializerProvider.java:341)
pizzanat-app  |         at com.fasterxml.jackson.databind.ObjectWriter$Prefetch.serialize(ObjectWriter.java:
1587)
pizzanat-app  |         at com.fasterxml.jackson.databind.ObjectWriter.writeValue(ObjectWriter.java:1061)
pizzanat-app  |         at org.springframework.http.converter.json.AbstractJackson2HttpMessageConverter.writ
eInternal(AbstractJackson2HttpMessageConverter.java:486)
pizzanat-app  |         ... 141 common frames omitted
pizzanat-app  | 2025-06-29 13:27:34.444 [PizzaNatOrders_bot Telegram Connection] ERROR o.t.t.u.DefaultBotSes
sion - Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict:
terminated by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.updates.GetUpdates.deserializeResponse
(GetUpdates.java:83)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.getUpda
tesFromServer(DefaultBotSession.java:258)
pizzanat-app  |         at org.telegram.telegrambots.updatesreceivers.DefaultBotSession$ReaderThread.run(Def
aultBotSession.java:188)
pizzanat-app  | 2025-06-29 13:27:36.022 [PizzaNatBot Telegram Connection] ERROR o.t.t.u.DefaultBotSession - 
Error executing org.telegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: termina
ted by other getUpdates request; make sure that only one bot instance is running
pizzanat-app  | org.telegram.telegrambots.meta.exceptions.TelegramApiRequestException: Error executing org.t
elegram.telegrambots.meta.api.methods.updates.GetUpdates query: [409] Conflict: terminated by other getUpdat
es request; make sure that only one bot instance is running
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eInternal(PartialBotApiMethod.java:54)
pizzanat-app  |         at org.telegram.telegrambots.meta.api.methods.PartialBotApiMethod.deserializeRespons
eArray(PartialBotApiMethod.java:39)

```

---

üéØ **–ù–∞—à–µ–ª –ø—Ä–æ–±–ª–µ–º—É!** 

–û—à–∏–±–∫–∞ –≤ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `LocalDateTime` –≤ JSON:
```
Java 8 date/time type `java.time.LocalDateTime` not supported by default: add Module "com.fasterxml.jackson.datatype:jackson-datatype-jsr310" to enable handling
```

–ü—Ä–æ–±–ª–µ–º–∞ –≤ `PaymentResponse["createdAt"]`. –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Jackson –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `LocalDateTime`. –î–∞–≤–∞–π—Ç–µ –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ:

---

Read file: src/main/java/com/baganov/pizzanat/model/dto/payment/PaymentResponse.java

---

–ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ `@JsonFormat` —É–∂–µ –µ—Å—Ç—å, –Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ Jackson –Ω–µ –º–æ–∂–µ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å `LocalDateTime` –±–µ–∑ –º–æ–¥—É–ª—è JSR310. –î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Jackson –≤ application.properties:

---

<details>
            <summary>Grep search for "jackson.*jsr310" ‚Ä¢ **0** files</summary>
        
No results found
</details>

---





---

