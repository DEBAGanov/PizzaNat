<!-- Generated by SpecStory -->

# Настройка CORS для проекта (2025-07-01 21:14:06)

_**User**_

Проанализируй проект и файлы папки @/docs   мне нужно прописать в CORS      'https://pizzanat.ru',
    'https://www.pizzanat.ru',
    'http://localhost:5173', // для разработки
    'http://localhost:3000'  // для тестирования

---

_**Assistant**_

Я проанализирую проект и найду, где нужно настроить CORS для указанных доменов. Давайте сначала найдем конфигурацию CORS в проекте.

---

<details>
            <summary>Searched codebase "CORS configuration" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `src/main/java/com/baganov/pizzanat/config/WebConfig.java` | L1-30 |
| `src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L36-80 |
| `docs/DOMAIN_SETUP_GUIDE.md` | L115-162 |
| `src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L176-227 |
| `src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L1-36 |
| `docs/DOMAIN_SETUP_GUIDE.md` | L1-47 |
| `src/main/resources/application.properties` | L147-185 |
| `docker-compose.production.yml` | L1-46 |
| `src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L148-176 |
| `scripts/test_cors_configuration.sh` | L96-153 |
| `scripts/test_cors_configuration.sh` | L1-60 |
| `scripts/test_cors_configuration.sh` | L153-215 |
| `docs/DOMAIN_SETUP_GUIDE.md` | L47-115 |
| `docs/DOMAIN_SETUP_GUIDE.md` | L162-223 |
| `scripts/test_cors_configuration.sh` | L215-260 |
| `env-yookassa-stage6.txt` | L88-119 |
| `scripts/test_cors_configuration.sh` | L260-276 |
| `docs/MOBILE_YOOKASSA_INTEGRATION_GUIDE.md` | L398-438 |
| `scripts/test_cors_configuration.sh` | L60-96 |
| `src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L126-148 |
| `src/main/resources/application.properties` | L59-111 |
| `docs/Tasktracker.md` | L329-351 |
| `src/main/resources/application.properties` | L111-147 |
| `docs/DOMAIN_SETUP_GUIDE.md` | L223-228 |
| `src/test/java/com/baganov/pizzanat/config/TestSecurityConfig.java` | L1-40 |

</details>

---

<details>
            <summary>Grep search for "@CrossOrigin" • **1** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15298 | `@CrossOrigin(origins = {"https://pizzanat.ru", "http://localhost:3000"})` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15375 | `<summary>Grep search for "@CrossOrigin" • **0** files</summary>` |

</details>

---

<details>
            <summary>Grep search for "CorsConfiguration" • **6** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L27 | `import org.springframework.web.cors.CorsConfiguration;` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L28 | `import org.springframework.web.cors.CorsConfigurationSource;` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L29 | `import org.springframework.web.cors.UrlBasedCorsConfigurationSource;` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L154 | `.cors(cors -> cors.configurationSource(corsConfigurationSource()))` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L162 | `.cors(cors -> cors.configurationSource(corsConfigurationSource()))` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L178 | `public CorsConfigurationSource corsConfigurationSource() {` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L179 | `CorsConfiguration configuration = new CorsConfiguration();` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L190 | `UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L191 | `source.registerCorsConfiguration("/**", configuration);` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-22_12-10-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F-%D0%B8-%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L39706 | `.cors(cors -> cors.configurationSource(corsConfigurationSource()))` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-22_12-10-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F-%D0%B8-%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L39715 | `.cors(cors -> cors.configurationSource(corsConfigurationSource()))` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-22_12-10-%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F-%D0%B8-%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L39731 | `UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-12_15-33-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-%D0%B1%D0%BE%D1%82%D0%BE%D0%BC.md` | L23674 | `.cors(cors -> cors.configurationSource(corsConfigurationSource()))` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-23_06-14-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-swagger.md` | L18264 | `import org.springframework.web.cors.CorsConfiguration;` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-23_06-14-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-swagger.md` | L18265 | `import org.springframework.web.cors.CorsConfigurationSource;` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-23_06-14-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-swagger.md` | L18387 | `import org.springframework.web.cors.CorsConfiguration;` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-23_06-14-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-swagger.md` | L18388 | `import org.springframework.web.cors.CorsConfigurationSource;` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L595 | `+ import org.springframework.web.cors.CorsConfiguration;` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L596 | `+ import org.springframework.web.cors.CorsConfigurationSource;` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L597 | `+ import org.springframework.web.cors.UrlBasedCorsConfigurationSource;` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L626 | `+                 .cors(cors -> cors.configurationSource(corsConfigurationSource()))` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L638 | `+     public CorsConfigurationSource corsConfigurationSource() {` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L639 | `+         CorsConfiguration configuration = new CorsConfiguration();` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L645 | `+         UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L646 | `+         source.registerCorsConfiguration("/**", configuration);` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L22109 | `.cors(cors -> cors.configurationSource(corsConfigurationSource()))` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L23713 | `+                     .cors(cors -> cors.configurationSource(corsConfigurationSource()))` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15389 | `⟪ 106 characters skipped ⟫ | `import org.springframework.web.cors.CorsConfiguration;` |` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15390 | `⟪ 106 characters skipped ⟫ | `import org.springframework.web.cors.CorsConfigurationSource;` |` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15391 | `⟪ 114 characters skipped ⟫rt org.springframework.web.cors.UrlBasedCorsConfigurationSource;` |` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15392 | `⟪ 110 characters skipped ⟫`.cors(cors -> cors.configurationSource(corsConfigurationSource()))` |` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15393 | `⟪ 110 characters skipped ⟫`.cors(cors -> cors.configurationSource(corsConfigurationSource()))` |` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15394 | `| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L150 | `public CorsConfigurationSource corsConfigurationSource() {` |` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15395 | `| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L151 | `CorsConfiguration configuration = new CorsConfiguration();` |` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15396 | `| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L158 | `UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();` |` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15397 | `| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L159 | `source.registerCorsConfiguration("/**", configuration);` |` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15454 | `public CorsConfigurationSource corsConfigurationSource() {` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15455 | `CorsConfiguration configuration = new CorsConfiguration();` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15491 | `UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15585 | `UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();` |

</details>

---

<details>
            <summary>Grep search for "allowedOrigins" • **5** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/WebConfig.java` | L17 | `private String[] allowedOrigins;` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/WebConfig.java` | L22 | `.allowedOrigins(allowedOrigins)` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L52 | `private String[] corsAllowedOrigins;` |
| `file:///Users/a123/Cursor/PizzaNat/src/main/java/com/baganov/pizzanat/config/SecurityConfig.java` | L182 | `configuration.setAllowedOrigins(Arrays.asList(corsAllowedOrigins));` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-12_15-33-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-%D0%B1%D0%BE%D1%82%D0%BE%D0%BC.md` | L21643 | `Проблема в CORS! В настройках CORS используется `setAllowedOrigins(List.of("*"))`, но это не работает с credentials. Для Postman нужно разрешить конкретные origins или использовать `setAllowCredentials(false)`. Давайте исправим это:` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-12_15-33-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-%D0%B1%D0%BE%D1%82%D0%BE%D0%BC.md` | L21775 | `+ - **Обновлены настройки CORS** - используется `setAllowedOriginPatterns` вместо `setAllowedOrigins`` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-12_15-33-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-%D0%B1%D0%BE%D1%82%D0%BE%D0%BC.md` | L22668 | `+ - **CORS конфигурация** - использование `setAllowedOriginPatterns` вместо `setAllowedOrigins`` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-12_15-33-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-%D0%B1%D0%BE%D1%82%D0%BE%D0%BC.md` | L22828 | `- Заменил `setAllowedOrigins(List.of("*"))` на `setAllowedOriginPatterns(List.of("*"))`` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-12_15-33-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B0-%D0%B8-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B-%D1%81-%D0%B1%D0%BE%D1%82%D0%BE%D0%BC.md` | L26820 | `- - **Обновлены настройки CORS** - используется `setAllowedOriginPatterns` вместо `setAllowedOrigins`` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L640 | `+         configuration.setAllowedOrigins(List.of("*"));` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L8004 | `.allowedOrigins("*")` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-05-06_19-43-%D0%BF%D0%BB%D0%B0%D0%BD-%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B8-%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-%D0%B4%D0%BB%D1%8F-%D0%BF%D0%B8%D1%86%D1%86%D1%8B.md` | L20222 | `.allowedOrigins("*")` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15434 | `+     private String[] allowedOrigins;` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15439 | `-                 .allowedOrigins("*")` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15442 | `+                 .allowedOrigins(allowedOrigins)` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15463 | `+         configuration.setAllowedOrigins(Arrays.asList(` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15530 | `+     private String[] corsAllowedOrigins;` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15553 | `-         configuration.setAllowedOrigins(Arrays.asList(` |
| `file:///Users/a123/Cursor/PizzaNat/.specstory/history/2025-06-23_14-54-%D0%B0%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7-%D0%B8-%D1%80%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC-%D1%81-api.md` | L15560 | `+         configuration.setAllowedOrigins(Arrays.asList(corsAllowedOrigins));` |

</details>

---

Отлично! Я нашел конфигурацию CORS в проекте. Вижу, что у вас уже есть настройки CORS в двух файлах:

1. `WebConfig.java` - для Spring MVC CORS
2. `SecurityConfig.java` - для Spring Security CORS

Сейчас я посмотрю текущие настройки и обновлю их в соответствии с вашими требованиями.

---

Read file: src/main/java/com/baganov/pizzanat/config/WebConfig.java

---

Read file: src/main/resources/application.properties

---

Теперь я вижу текущие настройки CORS. Мне нужно обновить их, добавив `https://www.pizzanat.ru` и `http://localhost:5173`. Сейчас я обновлю настройки в `application.properties`:

---



---

Теперь мне нужно также обновить WebConfig.java, чтобы по умолчанию включить новые домены:

---



---

Теперь мне нужно обновить SecurityConfig.java:

---

Read file: src/main/java/com/baganov/pizzanat/config/SecurityConfig.java

---

Теперь обновлю SecurityConfig.java:

---



---

Теперь мне нужно обновить docker-compose файлы, чтобы они также поддерживали новые домены. Давайте проверим docker-compose.production.yml:

---



---

Теперь проверим и обновим другие docker-compose файлы:

---

<details>
            <summary>Grep search for "CORS_ALLOWED_ORIGINS" • **2** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///Users/a123/Cursor/PizzaNat/docker-compose.production.yml` | L38 | `CORS_ALLOWED_ORIGINS: ${CORS_ALLOWED_ORIGINS:-https://pizzanat.ru,https://www.pizzanat.ru,https://api.pizzanat.ru,http://localhost:5173,http://localhost:3000,http://localhost:8080}` |
| `file:///Users/a123/Cursor/PizzaNat/docker-compose.production.yml` | L38 | `CORS_ALLOWED_ORIGINS: ${CORS_ALLOWED_ORIGINS:-https://pizzanat.ru,https://www.pizzanat.ru,https://api.pizzanat.ru,http://localhost:5173,http://localhost:3000,http://localhost:8080}` |

</details>

---

Теперь проверим env файлы:

---

<details>
            <summary>Grep search for "CORS_ALLOWED_ORIGINS" • **1** files</summary>
        
| File | Line | Match |
|------|------|-------|
| `file:///Users/a123/Cursor/PizzaNat/env-yookassa-stage6.txt` | L106 | `CORS_ALLOWED_ORIGINS=http://localhost:3000,https://pizzanat.ru,https://api.pizzanat.ru,android-app://com.pizzanat.app,ios-app://com.pizzanat.app` |

</details>

---

Обновлю env файл:

---



---

Теперь обновлю документацию. Сначала обновлю changelog.md:

---

Read file: docs/changelog.md

---

Теперь добавлю запись в changelog.md:

---



---

Теперь обновлю Tasktracker.md:

---

Read file: docs/Tasktracker.md

---

Теперь добавлю новую задачу в Tasktracker.md:

---



---

Теперь создам небольшой тестовый скрипт для проверки новых CORS настроек:

---

```diff
- 
+ #!/bin/bash
+ 
+ # Тестирование новых CORS доменов для PizzaNat
+ # Проверка поддержки https://www.pizzanat.ru и http://localhost:5173
+ 
+ set -e
+ 
+ # Цвета для вывода
+ RED='\033[0;31m'
+ GREEN='\033[0;32m'
+ YELLOW='\033[1;33m'
+ BLUE='\033[0;34m'
+ NC='\033[0m' # No Color
+ 
+ echo -e "${BLUE}🌐 Тестирование новых CORS доменов${NC}"
+ echo "=========================================="
+ echo
+ 
+ # Определяем базовый URL
+ if curl -s "http://localhost:8080/api/v1/health" >/dev/null 2>&1; then
+     BASE_URL="http://localhost:8080"
+ elif [[ "${PIZZANAT_URL:-}" ]]; then
+     BASE_URL="$PIZZANAT_URL"
+ else
+     echo -e "${RED}❌ API сервер недоступен${NC}"
+     echo "Убедитесь, что приложение запущено на localhost:8080"
+     echo "Или установите переменную PIZZANAT_URL"
+     exit 1
+ fi
+ 
+ echo -e "${BLUE}🎯 Используемый API: $BASE_URL${NC}"
+ echo
+ 
+ # Функция для тестирования CORS
+ test_cors_domain() {
+     local domain="$1"
+     local description="$2"
+     
+     echo -e "${YELLOW}🧪 Тестирование: $description${NC}"
+     echo "   🔗 Origin: $domain"
+     
+     # Выполняем preflight запрос
+     response=$(curl -s -w "\n%{http_code}" \
+         -X OPTIONS \
+         -H "Origin: $domain" \
+         -H "Access-Control-Request-Method: GET" \
+         -H "Access-Control-Request-Headers: Authorization,Content-Type" \
+         "$BASE_URL/api/v1/health" 2>/dev/null || echo -e "\n000")
+     
+     # Разделяем ответ и код статуса
+     http_code=$(echo "$response" | tail -1)
+     headers=$(echo "$response" | head -n -1)
+     
+     echo "   📊 HTTP Code: $http_code"
+     
+     # Проверяем заголовки CORS
+     allow_origin=$(echo "$headers" | grep -i "access-control-allow-origin" | head -1 || echo "")
+     
+     if [[ "$http_code" == "200" || "$http_code" == "204" ]]; then
+         if [[ -n "$allow_origin" && "$allow_origin" == *"$domain"* ]]; then
+             echo -e "   ✅ ${GREEN}УСПЕХ${NC} - CORS поддерживается"
+         elif [[ -n "$allow_origin" ]]; then
+             echo -e "   ⚠️  ${YELLOW}ЧАСТИЧНО${NC} - CORS настроен, но возможны ограничения"
+             echo "   📋 Заголовок: $allow_origin"
+         else
+             echo -e "   ❌ ${RED}ОШИБКА${NC} - CORS заголовки отсутствуют"
+         fi
+     else
+         echo -e "   ❌ ${RED}ОШИБКА${NC} - Неожиданный HTTP код: $http_code"
+     fi
+     
+     echo
+ }
+ 
+ # Тестируем новые домены
+ echo -e "${BLUE}📋 ТЕСТИРОВАНИЕ НОВЫХ ДОМЕНОВ${NC}"
+ echo "--------------------------------"
+ 
+ test_cors_domain "https://www.pizzanat.ru" "WWW версия основного домена"
+ test_cors_domain "http://localhost:5173" "Vite dev server"
+ 
+ echo -e "${BLUE}📋 ПРОВЕРКА СУЩЕСТВУЮЩИХ ДОМЕНОВ${NC}"
+ echo "------------------------------------"
+ 
+ test_cors_domain "https://pizzanat.ru" "Основной домен"
+ test_cors_domain "http://localhost:3000" "React dev server"
+ 
+ echo -e "${BLUE}📋 РЕЗУЛЬТАТ${NC}"
+ echo "=============="
+ echo -e "✅ ${GREEN}Новые домены добавлены в CORS конфигурацию${NC}"
+ echo -e "🔧 ${YELLOW}Для полного тестирования запустите:${NC} ./scripts/test_cors_configuration.sh"
+ echo -e "📚 ${BLUE}Документация обновлена в changelog.md и Tasktracker.md${NC}"
+ echo
+ 
+ exit 0 
```

---

Теперь сделаем скрипт исполняемым:

---

```bash
chmod +x scripts/test_new_cors_domains.sh
```

```
a123@MacBookAir PizzaNat % 

```

---

Отлично! Теперь давайте создадим краткую сводку выполненной работы:

## ✅ CORS настройки успешно обновлены

Я проанализировал проект и обновил CORS настройки для поддержки новых доменов согласно вашему запросу. Вот что было сделано:

### 🎯 Добавленные домены:
- ✅ `https://www.pizzanat.ru` - поддержка www-версии основного домена  
- ✅ `http://localhost:5173` - поддержка Vite dev server для разработки
- ✅ Сохранены все существующие домены: `https://pizzanat.ru`, `https://api.pizzanat.ru`, `http://localhost:3000`, `http://localhost:8080`

### 📝 Обновленные файлы:
1. **`src/main/resources/application.properties`** - обновлена переменная `app.cors.allowed-origins`
2. **`src/main/java/com/baganov/pizzanat/config/WebConfig.java`** - обновлены значения по умолчанию
3. **`src/main/java/com/baganov/pizzanat/config/SecurityConfig.java`** - обновлены значения по умолчанию  
4. **`docker-compose.production.yml`** - обновлена переменная окружения `CORS_ALLOWED_ORIGINS`
5. **`env-yookassa-stage6.txt`** - обновлена конфигурация

### 📚 Обновленная документация:
- **`docs/changelog.md`** - добавлена запись об обновлении CORS
- **`docs/Tasktracker.md`** - добавлена задача с деталями выполнения
- **`scripts/test_new_cors_domains.sh`** - создан тестовый скрипт для проверки новых доменов

### 🚀 Итоговый список поддерживаемых доменов:

**Продакшен:**
- `https://pizzanat.ru`
- `https://www.pizzanat.ru` ✨ **НОВЫЙ**
- `https://api.pizzanat.ru`

**Разработка:**
- `http://localhost:5173` ✨ **НОВЫЙ** (Vite)
- `http://localhost:3000` (React/Next.js)
- `http://localhost:8080` (Backend)

**Мобильные приложения:**
- `android-app://com.pizzanat.app`
- `ios-app://com.pizzanat.app`

### 🔧 Команды для проверки:
```bash
# Тестирование новых доменов
./scripts/test_new_cors_domains.sh

# Полное тестирование CORS
./scripts/test_cors_configuration.sh

# Перезапуск приложения для применения изменений
docker-compose restart
```

Все изменения выполнены в соответствии с принципами SOLID и следуют существующей архитектуре проекта. CORS настройки теперь готовы для работы с различными фронтенд-фреймворками и поддерживают как www-версию домена, так и современные инструменты разработки как Vite.

---

